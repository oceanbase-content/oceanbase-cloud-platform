# Create a primary tenant

A tenant can be seen as a container for database objects and resources such as CPU, memory, and I/O resources. You can create a primary tenant in a cluster based on your business needs.

You can create a primary tenant in the following ways in the OceanBase Cloud Platform (OCP) console:

* Create a primary tenant on the **Tenants** page.

* Create a primary tenant on the **Tenant Management** page of a specified cluster.

This topic describes how to create a primary tenant on the **Tenants** page.

## Prerequisites

* The cluster where you want to create a tenant is the running primary cluster.

* You have logged in with an account that has the privileges to manage the cluster. For example, you act as the system administrator or the OCP tenant administrator.

* Tenant names must be unique within the same cluster.
  
* The following conditions are met before you enable the arbitration service for a tenant:

  * The arbitration service is added for the cluster to which the tenant belongs, and the service is in the **Running** state.

  * The locality of the tenant includes two or four full-featured replicas.

  * The resources available on the server hosting the arbitration service meet the resource requirements.

    You can modify the resource requirements by using the following system parameters based on your business requirements. For more information, see [Modify system parameters](1600.manage-tenant-parameters/200.modify-a-tenant-parameter.md).

    * `ocp.arbitration.min.remain.disk.size`: the minimum size in MB of the clog disk on the arbitration service host required when the arbitration service is enabled for the tenant. The parameter value is in the (a,b) format, indicating the minimum clog disk sizes required when the tenant has two and four full-featured replicas, respectively. Default value: [12,24].
    * `ocp.arbitration.max.cpu.used.percentage`: the maximum CPU utilization in percentage (%) allowed on the arbitration service host when the arbitration service is enabled for the tenant. Default value: `90`.
    * `ocp.arbitration.max.memory.used.percentage`: the maximum memory usage in percentage (%) allowed on the arbitration service host when the arbitration service is enabled for the tenant. Default value: `90`.

* (Optional) You have created a parameter template by referring to [Manage tenant parameter templates](1500.manage-tenant-parameter-templates.md).

  If you need to create multiple tenants with the same parameter configuration, you can use a parameter template to avoid repeatedly configuring the same parameters.

## Procedure

1. Log in to the OCP console.

2. In the left-side navigation pane, select **Tenants**. The **Tenants** page automatically appears.

3. On the **Tenants** page, click **Create Tenant**.

   ![16310527](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/432/tennats.png)

4. Specify the parameters in the **Basic Settings** section. The following table describes the parameters.

   |    **Parameter**     | **Description** |
   |---------------|-------|
   | **Tenant Type**        | Select **Primary Tenant**. <blockquote>**Note**</br>If the tenant belongs to an OceanBase cluster of a version earlier than V4.2, you cannot select a tenant type. The default value is `Primary Tenant`. </blockquote> |
   | **Cluster**        | Select a cluster where the tenant is to be created. <blockquote>**Note**</br>When you create a primary tenant on the **Tenant Management** page of a specified cluster, the current cluster is used by default. </blockquote> |
   | **Tenant Name**       | The tenant name must start with a letter and end with a letter or a digit. It can contain letters, digits, and underscores (_). It must be 2 to 32 characters in length. |
   | **Administrator Password**   | The password of the tenant administrator account, which can be randomly generated. <ul><li>The administrator account is `root` in MySQL mode.   </li><li>The administrator account is `SYS` in Oracle mode. </li> </ul>The password must meet the following requirements:<ul><li>The password must be 8 to 32 characters in length.</li><li>The password must contain characters of at least three of the following types: digits (0 to 9), uppercase letters (A to Z), lowercase letters (a to z), and special characters. Supported special characters are: <code>~ ! @ # % ^ & * _ - + = \ | ( ) { } [ ] : ; , . ? /</code>. </li> </ul>|
   | **Character Set**    | <ul><li>In MySQL mode, the supported character sets are binary, utf8mb4, gbk, gb18030, latin1, gb18030_2022, ascii, and tis620. The default character set is utf8mb4.   </li><li>In Oracle mode, the supported character sets are utf8mb4, gbk, and gb18030. The default character set is utf8mb4. </li> </ul>   |
   | **Collation** | The collation corresponding to the specified character set. |
   | **Service Name**       | Optional. The service name is a new database access method provided by OceanBase Database. It can be considered as the alias of the cluster name and tenant name. This way, an application can access the database by using the service name. For more information, see [Manage service names](600.manage-a-tenant/800.manage-service-name.md). <ul><li>The service name must start with a letter and can contain letters, digits, and underscores (_). It must be 2 to 64 characters in length. </li><li>You can configure a service name for a tenant only when the following version requirements are met:<ul><li>OceanBase Database: V4.2.1.9, [V4.2.4.0, V4.3.0.0), or [V4.3.3.0, +∞) </li><li>OBProxy: [V4.3.1.0, +∞) </li></ul></li><br><main id="notice" type='explain'><h4>Note</h4><p>If **Service Name** has been configured for the primary tenant, the specified service name is automatically populated here. </p></main> |
   | **Remarks**        | This parameter is optional and allows you to add additional information. |
   | **Load Type**  | You can select a load type for the tenant. Select a load type based on the actual loads to avoid compromising the runtime performance metrics of the database. The following load types are supported:<ul><li>**Express OLTP**: suitable for workloads such as trading and core payment systems and high-throughput online applications. Such workloads do not involve restrictions such as foreign keys, stored procedures, long-running or large transactions, complex join operations, or complex subqueries. <br>Supported versions: This template applies to OceanBase Database V4.2.5 and later. </li><li>**HTAP**: suitable for hybrid transaction and analytical processing (HTAP) workloads. You can use it to quickly get insights from campaign operation data, fraud detection, and scenario-specific recommendations. <br>Supported versions: This template applies to OceanBase Database V4.2.5 and later. </li><li>**OLAP**: suitable for real-time data warehouse analytics. <br>Supported versions: This template applies to OceanBase Database V4.3.0 and later. </li><li>**Complex OLTP**: suitable for workloads such as banking and insurance systems. These workloads often involve complex join operations, complex subqueries, batch processing jobs compiled in PL, long-running transactions, and large transactions. Short-running queries are sometimes executed in parallel. <br>Supported versions: This template applies to OceanBase Database V4.2.5 and later. </li><li>**OBKV**: suitable for workloads that involve a high throughput and are sensitive to latency, such as key-value workloads and wide-column workloads of an HBase database. <br>Supported versions: This template applies to OceanBase Database V4.2.5 and later. </li></ul><main id="notice" type='explain'><h4>Note</h4><p>We recommend that the load type of the tenant be the same as that of the cluster to which it belongs. </p></main> |

   ![10](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/432/basic-settings-of-tenant.png)

5. Specify the parameters in the **Replica Settings** section.

   By default, the system displays configurable zones based on the zone information of the selected cluster. If you do not need to create a replica in a zone, click the **Delete** icon to delete the zone. The zone information parameters that need to be configured and their descriptions are listed in the following table.

   |    **Parameter**     | **Description** |
   |----------------|------|
   | Replica Type | The type of the replica. Select multiple full-featured replicas to ensure that they are in the majority. Valid values: <ul><li>**Full-featured Replica**: A standard replica that contains all the data categories and all the features, including MemTables, SSTables, and transaction logs. A full-featured replica can switch to the leader role efficiently to provide services.   </li><li>**Read-only Replica**: A replica that contains full logs, MemTables, and SSTables. It does not participate in log voting as a member of the Paxos group. Instead, it works as an observer that synchronizes logs from the Paxos group members and then locally replays the logs.   </li><li>**Log Replica**: A replica that contains only logs. It does not have a MemTable or an SSTable. It provides log services for external applications and participates in log voting. It can facilitate the restore of other replicas, but it cannot become the leader to provide database services. </li><li>**Read-only Columnstore Replica**: This type of replica does not participate in Paxos-based voting. Baseline data of all user tables is stored in columnar storage mode and supports only read operations. It applies to quasi-real-time decision analysis for hybrid load processing with enhanced transaction processing (TP) capabilities. </li></ul> <main id="notice" type='explain'><h4>Note</h4><p><ul><li>A distributed cluster of OceanBase Database V4.3.3 or later supports full-featured, read-only, and read-only columnstore replicas. </li><li>A distributed cluster of OceanBase Database V4.2.0 or a version later than V4.2.0 and earlier than V4.3.3 supports full-featured and read-only replicas. </li><li>A distributed cluster of OceanBase Database V4.0.0 or a version later than V4.0.0 and earlier than V4.2.0 supports only full-featured replicas. </li><li>A distributed cluster of OceanBase Database V3.x supports full-featured, read-only, and log replicas. </li><li>In a **standalone centralized** database, only full-featured replicas are supported. </li></ul></p></main> |
   | **Unit Specification**    | OCP has a set of built-in unit specifications. You can select the specification that you need from the list of unit specifications or click **Add Specification** at the bottom of the list to add a custom specification. For more information, see [OCP resource unit specifications](500.ocp-resource-unit-specifications.md). <main id="notice" type='notice'><h4>Notice</h4><p><ul><li>We recommend that you set the same specifications and number of units for all full-featured replicas. Different specifications or numbers of units can compromise the performance or stability. </li><li>If the OceanBase Database version of the cluster is V4.0.0 or later, take note of the following considerations:<ul><li>You cannot configure less than one CPU core for the tenant. </li><li>By default, the cluster limits the minimum memory size. You can adjust the limit by modifying the <code>__min_full_resource_pool_memory</code> parameter. For more information about how to modify the parameter of an OceanBase cluster of V4.1.0, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001375811">Modify cluster parameters</a>. </li></ul></li></li></ul></p></main>   |
   | **Units**    | The number of resource units in the zone. The number of resource units cannot exceed the number of OBServer nodes in the zone. <ul><li>If the cluster version is OceanBase Database V4.0 or later, you can only set the same number of units for all zones, which is 1 by default. </li><li>If the cluster version is earlier than OceanBase Database V4.0, you can set different numbers of units for different zones. </li><main id="notice" type='explain'><h4>Note</h4><p>In a **standalone centralized** database, the default number of units is **1**, which cannot be modified. </p></main>    |
   | **Zone Priority Rankings** | Specifies whether to define priorities for the zones of the tenant. The priorities affect the priority of the primary zone of the sys tenant. <ul><li>If this parameter is not specified, the zone priorities of the sys tenant are used by default. </li><li>If **Zone Priority Rankings** is enabled with no zone priorities, the random priority is used. </li><li>To configure zone priorities, you can select one or more zones from the list on the left that displays all zones in the current cluster and add the selected zones to the list on the right. By default, the priority of a zone added earlier is higher than that of a zone added later, and the zones added at the same time have the same priority. After you move the zones to the box on the right side, you can also drag them upward or downward to adjust their priority order. A zone takes priority over those beneath it. </li></ul><main id="notice" type='explain'><h4>Note</h4><p>In a **standalone centralized** database, the zone priority rankings are not displayed, and Zone1 has the highest priority by default. </p></main> |

   ![2](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/432/replica-setting.png)

6. Configure the parameters in the **Security Settings** section.

   * **Access from all IP addresses is supported**: This tenant can be accessed by any IP address.
      <main id="notice" type='notice'>
      <h4>Notice</h4>
      <p>This mode causes access security risks. Proceed with caution. </p>
      </main>

   * **Custom**: You can add allowed clients into the allowlist in the formats described in the following table. Here is an example:

     |   Format   |     Example     |
     |--------|-------|
     | IP Address          | xxx.xxx.xxx.1,xxx.xxx.xxx.2    |
     | Subnet/Mask  | xxx.xxx.xxx.1/24     |
     | Fuzzy match   | xxx.xxx.xxx.% or xxx.xxx.xxx._   |
     | Mixed | xxx.xxx.xxx.1,xxx.xxx.xxx.2,xxx.xxx.xxx.%,xxx.xxx.xxx._,xxx.xxx.xxx.1/24 |
     | Note   | % indicates that the tenant can be accessed from any client.      |

      <main id="notice" type='notice'>
      <h4>Notice</h4>
      <p>You must add the IP addresses of the OCP and OBProxy servers to the allowlist. Otherwise, you cannot manage the tenant from OCP. </p>
      </main>

   ![3](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/432/security-settings.png)

7. Enable **Parameter Settings** and configure the tenant parameters.

    * If you have selected a load type in the **Basic Settings** section, the system automatically selects the parameter template corresponding to the selected load type.

    * You can click the button in section ① of the following figure to add startup parameters one by one and set their values.

    * You can also click **Select Parameter Template** as shown in section ② of the following figure and select a parameter template. The system will automatically populate parameters in this section by using the template. If no tenant parameter template is available, you can click **Create Tenant Parameter Template** to create one. For more information, see [Manage tenant parameter templates](1500.manage-tenant-parameter-templates.md).

         The system provides four built-in templates that contain general parameters. You can use a template for cluster configuration. The following table describes the built-in templates.

         | Template | Description |
         |------|----------|
         | Default Parameter Template for COMPLEX_OLTP   | The default template for the **Complex OLTP** load type. It applies only to OceanBase Database V4.2.5 and later.   |
         | Default Parameter Template for HTAP   | The default template for the **HTAP** load type. It applies only to OceanBase Database V4.2.5 and later. |
         | Default Parameter Template for OLAP   | The default template for the **OLAP** load type. It applies only to OceanBase Database V4.3.0 and later.   |
         | Default Parameter Template for EXPRESS_OLTP   | The default template for the **Express OLTP** load type. It applies only to OceanBase Database V4.2.5 and later.   |

    <main id="notice" type='explain'>
    <h4>Note</h4>
    If you are creating a tenant in MySQL mode by using a parameter template that contains parameters that are valid only in Oracle mode, you must manually delete those parameters.
    </main>

   ![1201](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/432/parameter-settings-of-tenant.png)

8. Click **Submit**. The page that appears prompts you that the tenant creation task has been submitted and displays the summary information of the task.

    * To view the task details, click **View Task Details**.
    * To return to the **Tenants** list, click **Return to Tenants List**. In the **Tenants** list, you can view the status and task details of the new tenant, and delete the tenant if the tenant creation failed.

    <main id="notice" type='explain'>
    <h4>Note</h4>
    <p>When the task status is <strong>Completed</strong>, you can check the status of the new tenant in the <strong>Tenants</strong> list on the <strong>Tenant Management</strong> page. The new tenant is created if its status is <strong>Running</strong>. </p>
    </main>
