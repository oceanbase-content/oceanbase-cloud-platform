# Metrics for the SQL execution phase

This topic describes the following metrics for monitoring the SQL execution phase of OceanBase Database tenants: `in_parse`, `in_pl_parse`, `in_plan_cache`, `in_sql_optimize`, `in_sql_execution`, `in_px_execution`, `in_sequence_load`, `in_committing`, `in_storage_read`, `in_storage_write`, `in_remote_das_execution`, `in_plsql_compilation`, and `in_plsql_execution`. You can specify a statistical period to query the SQL execution metrics of a tenant in a single zone or on a single OBServer node.

## in_parse

### Definition

The number of active sessions in which SQL parsing is being performed within the statistical period.

### Description

| **Metric** | **Metric name** | **Unit** | **Supported version** |
|---------|-------------------|--------|-------|
| in_parse | sql_event_in_parse | N/A | OceanBase Database V4.2.0.0 and later but earlier than V4.3.0.0 |

### Calculation expression

sum(ob_sql_event_in_parse{@LABELS}) by (@GBLABELS)

### SQL statements for metric collection

* OceanBase Database V4.2.0.0 and later but earlier than V4.2.1.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

* OceanBase Database V4.2.1.0 and later but earlier than V4.2.2.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

* OceanBase Database V4.2.2.0 and later but earlier than V4.3.0.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_COMPILATION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_COMPILATION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_FILTER_ROWS = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_FILTER_ROWS FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

## in_pl_parse

### Definition

The number of active sessions in which PL parsing is being performed within the statistical period.

### Description

| **Metric** | **Metric name** | **Unit** | **Supported version** |
|---------|--------------------------|--------|-------|
| in_pl_parse | sql_event_in_pl_parse | N/A | OceanBase Database V4.2.0.0 and later but earlier than V4.3.0.0 |

### Calculation expression

sum(ob_sql_event_in_pl_parse{@LABELS}) by (@GBLABELS)

### SQL statements for metric collection

* OceanBase Database V4.2.0.0 and later but earlier than V4.2.1.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

* OceanBase Database V4.2.1.0 and later but earlier than V4.2.2.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

* OceanBase Database V4.2.2.0 and later but earlier than V4.3.0.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_COMPILATION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_COMPILATION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_FILTER_ROWS = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_FILTER_ROWS FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

## in_plan_cache

### Definition

The number of active sessions in which the plan cache is being accessed within the statistical period.

### Description

| **Metric** | **Metric name** | **Unit** | **Supported version** |
|---------|----------------------------|--------|--------|
| in_plan_cache | sql_event_in_plan_cache | N/A | OceanBase Database V4.2.0.0 and later but earlier than V4.3.0.0 |

### Calculation expression

sum(ob_sql_event_in_plan_cache{@LABELS}) by (@GBLABELS)

### SQL statements for metric collection

* OceanBase Database V4.2.0.0 and later but earlier than V4.2.1.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

* OceanBase Database V4.2.1.0 and later but earlier than V4.2.2.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

* OceanBase Database V4.2.2.0 and later but earlier than V4.3.0.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_COMPILATION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_COMPILATION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_FILTER_ROWS = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_FILTER_ROWS FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

## in_sql_optimize

### Definition

The number of active sessions in which SQL optimization is being performed within the statistical period.

### Description

| **Metric** | **Metric name** | **Unit** | **Supported version** |
|---------|---------------------------|--------|-------|
| in_sql_optimize | sql_event_in_sql_optimize | N/A | OceanBase Database V4.2.0.0 and later but earlier than V4.3.0.0 |

### Calculation expression

sum(ob_sql_event_in_sql_optimize{@LABELS}) by (@GBLABELS)

### SQL statements for metric collection

* OceanBase Database V4.2.0.0 and later but earlier than V4.2.1.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

* OceanBase Database V4.2.1.0 and later but earlier than V4.2.2.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

* OceanBase Database V4.2.2.0 and later but earlier than V4.3.0.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_COMPILATION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_COMPILATION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_FILTER_ROWS = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_FILTER_ROWS FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

## in_sql_execution

### Definition

The number of active sessions in which an SQL statement is being executed within the statistical period.

### Description

| **Metric** | **Metric name** | **Unit** | **Supported version** |
|---------|---------------------------|--------|--------|
| in_sql_execution | sql_event_in_sql_execution | N/A | OceanBase Database V4.2.0.0 and later but earlier than V4.3.0.0 |

### Calculation expression

sum(ob_sql_event_in_sql_execution{@LABELS}) by (@GBLABELS)

### SQL statements for metric collection

* OceanBase Database V4.2.0.0 and later but earlier than V4.2.1.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

* OceanBase Database V4.2.1.0 and later but earlier than V4.2.2.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

* OceanBase Database V4.2.2.0 and later but earlier than V4.3.0.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_COMPILATION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_COMPILATION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_FILTER_ROWS = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_FILTER_ROWS FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

## in_px_execution

### Definition

The number of active sessions in which SQL statements are being executed in parallel within the statistical period.

### Description

| **Metric** | **Metric name** | **Unit** | **Supported version** |
|---------|---------------------------|--------|--------|
| in_px_execution | sql_event_in_px_execution | N/A | OceanBase Database V4.2.0.0 and later but earlier than V4.3.0.0 |

### Calculation expression

sum(ob_sql_event_in_px_execution{@LABELS}) by (@GBLABELS)

### SQL statements for metric collection

* OceanBase Database V4.2.0.0 and later but earlier than V4.2.1.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

* OceanBase Database V4.2.1.0 and later but earlier than V4.2.2.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

* OceanBase Database V4.2.2.0 and later but earlier than V4.3.0.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_COMPILATION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_COMPILATION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_FILTER_ROWS = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_FILTER_ROWS FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

## in_sequence_load

### Definition

The number of active sessions in which values are being generated for an auto-increment column or a sequence within the statistical period.

### Description

| **Metric** | **Metric name** | **Unit** | **Supported version** |
|---------|---------------------------|--------|-------|
| in_sequence_load | sql_event_in_sequence_load | N/A | OceanBase Database V4.2.0.0 and later but earlier than V4.3.0.0 |

### Calculation expression

sum(ob_sql_event_in_sequence_load{@LABELS}) by (@GBLABELS)

### SQL statements for metric collection

* OceanBase Database V4.2.0.0 and later but earlier than V4.2.1.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

* OceanBase Database V4.2.1.0 and later but earlier than V4.2.2.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

* OceanBase Database V4.2.2.0 and later but earlier than V4.3.0.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_COMPILATION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_COMPILATION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_FILTER_ROWS = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_FILTER_ROWS FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

## in_committing

### Definition

The number of active sessions in which a transaction is being committed within the statistical period.

### Description

| **Metric** | **Metric name** | **Unit** | **Supported version** |
|---------|---------------------------|--------|--------|
| in_committing | sql_event_in_committing | N/A | OceanBase V4.2.1.0 and later but earlier than V4.3.0.0 |

### Calculation expression

sum(ob_sql_event_in_committing{@LABELS}) by (@GBLABELS)

### SQL statements for metric collection

* OceanBase Database V4.2.1.0 and later but earlier than V4.2.2.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

* OceanBase Database V4.2.2.0 and later but earlier than V4.3.0.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_COMPILATION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_COMPILATION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_FILTER_ROWS = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_FILTER_ROWS FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

## in_storage_read

### Definition

The number of active sessions in which a storage-layer read operation is being performed within the statistical period.

### Description

| **Metric** | **Metric name** | **Unit** | **Supported version** |
|---------|---------------------------|--------|-------|
| in_storage_read | sql_event_in_storage_read | N/A | OceanBase V4.2.1.0 and later but earlier than V4.3.0.0 |

### Calculation expression

sum(ob_sql_event_in_storage_read{@LABELS}) by (@GBLABELS)

### SQL statements for metric collection

* OceanBase Database V4.2.1.0 and later but earlier than V4.2.2.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

* OceanBase Database V4.2.2.0 and later but earlier than V4.3.0.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_COMPILATION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_COMPILATION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_FILTER_ROWS = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_FILTER_ROWS FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

## in_storage_write

### Definition

The number of active sessions in which a storage-layer write operation is being performed within the statistical period.

### Description

| **Metric** | **Metric name** | **Unit** | **Supported version** |
|---------|---------------------------|--------|--------|
| in_storage_write | sql_event_in_storage_write | N/A | OceanBase V4.2.1.0 and later but earlier than V4.3.0.0 |

### Calculation expression

sum(ob_sql_event_in_storage_write{@LABELS}) by (@GBLABELS)

### SQL statements for metric collection

* OceanBase Database V4.2.1.0 and later but earlier than V4.2.2.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

* OceanBase Database V4.2.2.0 and later but earlier than V4.3.0.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_COMPILATION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_COMPILATION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_FILTER_ROWS = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_FILTER_ROWS FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

## in_remote_das_execution

### Definition

The number of active sessions in which remote execution by using Database Autonomy Service (DAS) is in progress within the statistical period.

### Description

| **Metric** | **Metric name** | **Unit** | **Supported version** |
|---------|---------------------------|--------|---------|
| in_remote_das_execution | sql_event_in_remote_das_execution | N/A | OceanBase V4.2.1.0 and later but earlier than V4.3.0.0 |

### Calculation expression

sum(ob_sql_event_in_remote_das_execution{@LABELS}) by (@GBLABELS)

### SQL statements for metric collection

* OceanBase Database V4.2.1.0 and later but earlier than V4.2.2.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

* OceanBase Database V4.2.2.0 and later but earlier than V4.3.0.0:

   ```sql
   SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_COMPILATION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_COMPILATION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_FILTER_ROWS = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_FILTER_ROWS FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
   ```

## in_plsql_compilation

### Definition

The number of active sessions in which PL compilation is being performed within the statistical period.

### Description

| **Metric** | **Metric name** | **Unit** | **Supported version** |
|---------|---------------------------|--------|--------|
| in_plsql_compilation | sql_event_in_plsql_compilation | N/A | OceanBase V4.2.2.0 and later but earlier than V4.3.0.0 |

### Calculation expression

sum(ob_sql_event_in_plsql_compilation{@LABELS}) by (@GBLABELS)

### SQL statements for metric collection

OceanBase Database V4.2.2.0 and later but earlier than V4.3.0.0:

```sql
SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_COMPILATION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_COMPILATION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_FILTER_ROWS = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_FILTER_ROWS FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
```

## in_plsql_execution

### Definition

The number of active sessions in which PL execution is being performed within the statistical period.

### Description

| **Metric** | **Metric name** | **Unit** | **Supported version** |
|---------|---------------------------|--------|---------|
| in_plsql_execution | sql_event_in_plsql_execution | N/A | OceanBase V4.2.2.0 and later but earlier than V4.3.0.0 |

### Calculation expression

sum(ob_sql_event_in_plsql_execution{@LABELS}) by (@GBLABELS)

### SQL statements for metric collection

OceanBase Database V4.2.2.0 and later but earlier than V4.3.0.0:

```sql
SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_COMPILATION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_COMPILATION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_FILTER_ROWS = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_FILTER_ROWS FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
```

## in_filter_rows

### Definition

The number of active sessions in which operator pushdown is being performed within the statistical period.

### Description

| **Metric** | **Metric name** | **Unit** | **Supported version** |
|---------|---------------------------|--------|---------|
| in_filter_rows | sql_event_in_filter_rows | N/A | OceanBase V4.2.2.0 and later but earlier than V4.3.0.0 |

### Calculation expression

sum(ob_sql_event_in_filter_rows{@LABELS}) by (@GBLABELS)

### SQL statements for metric collection

OceanBase Database V4.2.2.0 and later but earlier than V4.3.0.0:

```sql
SELECT /*+ MONITOR_AGENT */ t.tenant_id tenant_id, COALESCE(CAST(SUM(CASE WHEN IN_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PL_PARSE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PL_PARSE, COALESCE(CAST(SUM(CASE WHEN IN_PLAN_CACHE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLAN_CACHE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_OPTIMIZE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_OPTIMIZE, COALESCE(CAST(SUM(CASE WHEN IN_SQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PX_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PX_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_SEQUENCE_LOAD = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_SEQUENCE_LOAD, COALESCE(CAST(SUM(CASE WHEN IN_COMMITTING = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_COMMITTING, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_READ = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_READ, COALESCE(CAST(SUM(CASE WHEN IN_STORAGE_WRITE = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_STORAGE_WRITE, COALESCE(CAST(SUM(CASE WHEN IN_REMOTE_DAS_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_REMOTE_DAS_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_COMPILATION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_COMPILATION, COALESCE(CAST(SUM(CASE WHEN IN_PLSQL_EXECUTION = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_PLSQL_EXECUTION, COALESCE(CAST(SUM(CASE WHEN IN_FILTER_ROWS = 1 THEN 1 ELSE 0 END) AS SIGNED INTEGER), 0) AS IN_FILTER_ROWS FROM (select * from oceanbase.__all_virtual_ash WHERE sample_time between now() - INTERVAL 1 SECOND and now()) ash right join (select distinct tenant_id from dba_ob_tenants) t on ash.tenant_id = t.tenant_id group by tenant_id
```
