# OCP V4.3.0

## V4.3.0 BP1

### Version information

* **Current version:** V4.3.0 BP1

* **Previous version:** V4.3.0

* **Release date:** June 14, 2024

### Product optimizations

* **Cluster management**

  The prompt in standalone mode is optimized as follows: The standalone centralized architecture supports only one data replica, which means data loss may occur when storage or hardware fails. We recommend that you regularly back up critical business systems or configure high availability (HA) solutions, such as tenant-level primary/standby databases and multi-replica disaster recovery, to avoid single points of failure.

* **Cluster management**

  In OceanBase Database V4.2.1.7 and later other than V4.2.2, V4.2.3, and V4.3.0, slogs and the log disk share storage space. We recommend that you reserve 4 GiB of storage space for slogs.

* **Alert center**

  The alert threshold for the log disk usage of a tenant is changed from 95% to 85%.

### Bug fixes

* Fixed the issue where OceanBase Cloud Platform (OCP) V4.3.0 failed to perform immediate backup for a V3.x cluster with log backup enabled.

* Fixed the issue where the OCP upgrade failed when OceanBase Database V1.4.79 was used as MetaDB.

* Fixed the issue where self-healing alerts could not be triggered after OCP was upgraded from V3.1.x or earlier to V4.x.

## V4.3.0

OCP V4.3.0 supports OceanBase Database V4.3.0. This version provides **information collection** and **plan management** features to help you collect error information and automatically handle anomalies, improving fault diagnostics efficiency and business continuity and stability.

In addition, this version supports CPU overprovisioning. You can configure CPU resources based on your business conditions to maximize resource utilization. It also provides more fine-grained wait event monitoring metrics based on the 3A time model. This helps you analyze and resolve system issues more efficiently. Furthermore, OCP V4.3.0 has made more than 20 optimizations and enhancements in basic operation and maintenance (O&M), monitoring and alerting, backup and restore, third-party integration, and other aspects, to improve its ease-of-use, stability, and compatibility. The new version serves as a better database lifecycle management platform that helps you manage OceanBase Database more simply and efficiently.

### Version information

* **Current version:** V4.3.0

* **Previous version:** V4.2.2 BP2

* **Release date:** May 24, 2024

* **Supported upgrade paths:**

  * You can directly upgrade OCP V3.2.4 and later to the current version.

  * To upgrade OCP V2.3.x and later but earlier than V3.2.4 to the current version, you need to upgrade to OCP V3.3.4 first.

  * If you use OCP of a version earlier than V2.3.0, you must first upgrade to OCP V2.3.x and then to V3.3.4.

### Supported OceanBase Database versions

OCP V4.3.0 supports the following versions of OceanBase Database.

* OceanBase Database V1.4.x

* OceanBase Database V2.1.x

* OceanBase Database V2.2.x

* OceanBase Database V3.1.x

* OceanBase Database V3.2.x

* OceanBase Database V4.x

### New features

#### Compatibility with OceanBase Database V4.x

* OCP V4.3.0 supports the multi-cluster mode, which allows you to create tenant-level primary and standby databases and further enhance your disaster recovery solutions based on OceanBase Database.
* Cluster-level and tenant-level `Complex_OLTP`, `Express_OLTP`, `OLAP`, `HTAP`, and `OBKV` parameter templates are provided. These parameter templates simplify the configuration of cluster and tenant parameters and reduce database configuration costs.
* OCP V4.3.0 detects OBProxy session IDs. This allows you to locate sessions in a distributed database and terminate specified sessions by using external applications.
* OCP V4.3.0 supports Tencent Cloud Object Storage `(COS)` for tenant-level primary and standby databases.

#### CPU overprovisioning

Generally, the traffic to tenants in a cluster peaks at different hours of a day due to different business attributes. For example, `Business A` is highly loaded from 9:00 to 11:00, and handles a low load from 13:00 to 16:00, while `Business B` features an opposite traffic pattern. In this case, you can configure the cluster and tenant specifications and CPU overprovisioning based on peak hours to ensure stable business operation and improve the resource utilization of the cluster at lower costs.

### Feature improvements

#### Basic O&M

* **Arbitration service management**

    OCP V4.3.0 supports the `enable_syslog_recycle` and `max_syslog_file_count` parameters. You can set these parameters when you create an arbitration service to prevent arbitration service failures caused by a full working directory replete with log records.

* **OBProxy management**

    OCP V4.3.0 automatically skips inaccessible hosts when you delete an OBProxy cluster. This increases the success rate of cluster deletion tasks.

#### Alert center

* The logic of automatic alert clearing is optimized. OCP V4.3.0 allows you to enable or disable automatic alert clearing. You can choose to handle alerts manually.
* OCP V4.3.0 supports alerting on the memory that is not released by a frozen MemStore.
* OCP V4.3.0 allows you to configure the template for alert clearance messages on the **Alert Channels** tab of **Alert Center**.
* More than 60 OceanBase log alerts are added to help you detect system exceptions in time.
* OCP V4.3.0 eliminates logon authentication for documents. You can now access documents related to alerts from external systems, such as email and DingTalk, without logging on to OCP.

#### Performance monitoring

* OCP V4.3.0 provides monitoring charts for multiple wait events based on the 3A time model, such as events related to **DB time**, **frontend workloads**, **backend workloads**, and **SQL execution events**, to help you analyze system bottlenecks in a fine-grained manner, thereby improving the observability of OceanBase Database.
* OCP V4.3.0 allows you to select multiple monitoring objects or metrics, so that the system automatically generates multiple single-object single-metric charts named in the "object: metric" format. You can also create charts in batches.

#### Software package management

OCP V4.3.0 is compatible with OceanBase Database RPM packages with `nolse` marks, solving issues in identifying Large System Extensions (LSE) instructions in the Arm architecture.

#### APIs

* OCP V4.3.0 allows you to perform backup and restore operations, such as setting the period of log pieces and previewing restore tasks, by using APIs. You can call the `addRestoreSource` operation for data restore.
* You can call operations through APIs to query the relationships between tenants and OBServer nodes.

### Product optimizations

* **Cluster management**

  * The **Cluster** page provides the **Arbitration Service** and **Parameter Template** tabs.
  * You can modify the CPU, memory, data disk, and log disk parameters as needed. By default, the maximum disk usage is 90%.
  * The ConfigURL parameter supports service caching, which resolves MetaDB service unavailability in multi-cloud and cross-cloud deployment, further improving OCP service availability.
  * When you upgrade a cluster of OceanBase Database V4.2.1 or later, OCP prompts the version mappings between OceanBase Database and the Oracle Call Interface (OCI) library to help prevent unexpected cluster crash.
  * When you replace an OBServer node, OCP displays hosts of the same type in the same region, which saves a great amount of time for querying suitable hosts in a large cluster.

* **Tenant management**
  
  * The **Tenants** page provides the **Unit Specification** and **Parameter Template** tabs.
  * When you scale a tenant or migrate units, OCP prompts you to modify the `ha_high_thread_score` and `ha_mid_thread_score` parameters or perform resource isolation for backend tasks. These measures prevents business from being affected by traffic surges caused by partition replica migration.
  * When you delete a tenant, OCP prompts you that the resource pool and data of the tenant will also be deleted, and that the tenant will not be removed to the recycle bin.
  * OCP V4.3.0 supports the display of and resource isolation for the `ocp_monitor` tenant to minimize the impact of system monitoring on the business.

* **Host management**

  * The **Hosts** page displays key information about hosts, such as the host name, model, IDC, and region.
  * When you add a host, OCP prompts you that you can enter multiple IP addresses.

* **Alert center**

  * In OCP V4.3.0, information about the cluster, server, and generation time is provided for active and historical alerts on the **Alert Events** tab of **Alert Center**.
  * An Edit icon is provided on the **Alert Rules** tab.
  * OCP V4.3.0 supports alert message aggregation in two dimensions: cluster and alert item. This way, alerts of the same type on different clusters can be aggregated without causing contact inconsistency issues.

* **Backup and restore**

  * When you stop log backup, OCP V4.3.0 prompts that if you want to permanently disable log backup when the backup strategy is enabled, you must also disable or delete the backup strategy.
  * If you enable log archiving for a cluster of OceanBase Database V2.2.52 or later, OCP V4.3.0 enables the piece mechanism by default. The default period of a piece is 1 day.

* **Task management**

  OCP V4.3.0 supports manual retries on subtasks of the Warning type.

* **Credential management**

  The requirements on the credential name length are unified for credential import and editing.

* OCP V4.3.0 supports interconnection with time series databases based on Prometheus for storing the data of monitoring views.

### Product behavioral changes

* **Cluster management**

    When the cgroup directory does not exist and the OceanBase cluster version is V4.0.0 or later, OCP V4.3.0 creates the cgroup directory by default when taking over an OBServer node.

* **Tenant management**

    The monitoring metric **CPU Consumption of Tenant** is added in the **Resource Usage Trend** section of the **Resource Management** page of a tenant.

### Key features

#### CPU overprovisioning

CPU overprovisioning allows the total amount of CPU resources allocated to a tenant to exceed the actual physical CPU resources available. OCP V4.3.0 allows you to specify the CPU overprovisioning ratio when you create a cluster. The maximum ratio is 200%. When you create a unit, you can specify the maximum and minimum numbers of CPU cores for the unit. OCP V4.3.0 also allows you to disable CPU overprovisioning and adjust the overprovisioning ratio for cluster management as needed.

Here are some typical CPU overprovisioning scenarios:

1. Business integration: You can deploy business lines with different peak hours in the same cluster. For example, you can deploy daytime transaction business together with nighttime batch processing or analysis business to make full use of the cluster resources.

2. Tolerance for traffic surges: If an essential business tenant may experience traffic surges, you can configure CPU overprovisioning for the tenant, so that it can take more resources over others within seconds to maintain stable operation.

<main id="notice" type='explain'>
<h4>Note</h4>
CPU overprovisioning is available only in OceanBase Database V4.0.0 or later. To enable CPU overprovisioning for a cluster, you must also enable the cgroup feature.
</main>

#### Plan management

The plan management feature allows you to prepare and implement a series of plans for possible database emergencies and crises. This feature enhances your response to emergencies and crises, reduces losses, and ensures database operation stability, thereby mitigating the impact of potential risks on your business and improving the overall response performance of OceanBase Database.

The plan management feature consists of the **Plan** and **Plans** tabs.

1. **Plan**: This tab provides 11 plans for different scenarios, such as automatically reloading the observer process, increasing the CPU and memory resources of a tenant, and flushing the plan cache for an SQL statement. You can create a custom plan based on the business scenario and resource usage. For example, you can create a custom resource increasing plan and specify whether to enable the plan.

2. **Plans**: This tab provides plan execution information, rollback solutions, and details of corresponding SQL statements. You can manually execute plans for which automatic execution is disabled. Plan management can help you establish an emergency management mechanism and O&M specifications for OceanBase Database, ensuring business continuity and stability in an intelligent manner.

### Bug fixes

The following issues are fixed in OCP V4.3.0:

* Fixed the issue where the minor compaction feature checked for an OceanBase cluster upgrade failed to take effect.
* Fixed the issue of partial collection of OAS transaction data when many concurrent transactions were in progress.
* Fixed the issue where the displayed usage of log disk resources was abnormal.
* Fixed the issue where the total number of SQL statements of a certain type displayed on the **Autonomous Service** page did not match the actual number.
* Fixed the issue of data inaccuracy when you drilled down the queries per second (QPS) metric to the tenant dimension.
* Fixed the issue of OCP-Agent memory leaks, which caused OCP-Agent to use more memory than expected.

### Known issues

| No. | Known issue | Solution |
|----|---------|---------------|
| 1 | The performance data of the standby cluster remains 0 in the primary/standby cluster topology. | None. |
| 2 | If an OceanBase cluster managed by an OCP cluster has a standby tenant created based on log archiving, and the OceanBase cluster is migrated from the OCP cluster and then taken over again by the OCP cluster, the tenants are no longer in the original primary/standby relationship. | This issue is rare. No solution is available. |
| 3 | In the **Capacity Usage Overview** section of the **Tenant Management** page of a cluster, the charts are not properly displayed if the tenant name is long. | None. |
| 4 | Some SQL diagnostic information is missing. | The issue will be fixed in later versions. |

## Limitations

### Hardware requirements

OCP-Server can be installed on a physical server or in a Docker container. OCP-Server supports the multi-node HA deployment mode.

The following table lists the minimum hardware requirements of an OCP-Server node.

| Hardware | Requirement |
|-------|------------------------------------|
| CPU | <li>x86_64 processor with 8 cores</li><li>AArch64 processor with 8 cores</li> |
| Memory | 16 GiB available memory |
| NIC | 10 Gbit/s NIC |

OCP-Agent takes up few resources and has no special requirements for hardware.

### Operating system requirements

The following table lists the operating system requirements for installing OCP-Server (including OCP-Agent).

| Server architecture | Operating system | Supported version |
|-------------|------------|-----------|
| x86_64 | Red Hat Enterprise Linux (RHEL) | 7.2 and later |
| x86_64 | CentOS | 7.2 and later |
| x86_64 | AliOS | 7.2 and later |
| x86_64 | openSUSE | 12SP3 and later |
| AArch64 | AliOS | 7.2 and later |
| AArch64 | NeoKylin | 7.6 |
| AArch64 | Huawei EulerOS | 2.0 SP8 |
| x86_64 | Debian | Debian GNU/Linux 11 (bullseye) |
| x86_64 | Ubuntu | Ubuntu 18.04.6 LTS |

### Client requirements

Generally, users use browsers to access OCP. The following client requirements apply.

| Browser | Earliest supported version |
|---------|------|
| Chrome | 88 |
| Firefox | 78 |
| Safari | 14 |
| Edge | 88 |

If you need to access OCP from an iOS device, the iOS version must meet the requirement listed in the following table.

| Operating system | Earliest supported version |
|------|------|
| iOS | 10 |

We recommend that you use displays with a resolution greater than 1440 × 810 to ensure optimal use experience.
