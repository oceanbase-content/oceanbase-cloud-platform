# OCP V4.3.2

OceanBase Cloud Platform (OCP) V4.3.2 is fully compatible with OceanBase Database V4.3.2 and earlier versions. The new version provides the tenant cloning feature, which can implement data isolation and improve efficiency in various business scenarios such as database changes, releases of new application versions, and building a development or test environment. It supports CPU core binding. You can properly configure CPU core binding to significantly improve the performance in scenarios where OceanBase Database and OBProxy are deployed on the same ARM-based server. It also supports the monitoring of OBKV-Table and OBKV-HBase instances to better monitor the performance of OceanBase Database. Furthermore, OCP V4.3.2 has made more than 20 optimizations and enhancements in aspects such as basic O&M, performance monitoring, O&M configuration, and external integration, and has improved its ease-of-use and stability based on user experience, to help you manage OceanBase Database more efficiently.

## Version information

* **Current version:** V4.3.2

* **Previous version:** V4.3.1 BP1

* **Release date:** September 23, 2024

* **Supported upgrade paths:**

  * You can directly upgrade OCP V3.2.4 and later to the current version.

  * To upgrade OCP V2.3.x and later but earlier than V3.2.4 to the current version, you need to upgrade OCP to V3.3.4 first.

  * If you use OCP of a version earlier than V2.3.0, you must upgrade OCP first to V2.3.x and then to V3.3.4.

## Supported OceanBase Database versions

OCP V4.3.2 supports the following versions of OceanBase Database:

* OceanBase Database V4.x
* OceanBase Database V3.2.x
* OceanBase Database V3.1.x
* OceanBase Database V2.2.x
* OceanBase Database V2.1.x
* OceanBase Database V1.4.x

## New features

#### Basic O&M

* **Tenant cloning**: implements data isolation and improves efficiency for business systems. For more information, see the **Key features** section of this topic.

    <main id="notice" type='explain'>
    <h4>Note</h4>
    Only OceanBase Database V4.3.0 and later support tenant cloning.
    </main>

* **CPU core binding configuration**: significantly improves the performance in scenarios where OceanBase Database and OBProxy are deployed on the same ARM-based server.

* **Tenant renaming**: allows you to access a production or test database without modifying the database connection string.

* **Support for the Simple Storage Service (S3) protocol**: supports storage media that are compatible with the S3 protocol of Amazon Web Services (AWS) in primary/standby tenant mode.

    <main id="notice" type='explain'>
    <h4>Note</h4>
    The S3 protocol is supported only if the cluster to which the tenant belongs meets the following version requirements:
    <ul><li>OceanBase Database V4.2.x: V4.2.1.6 or later</li><li>OceanBase Database V4.3.x: V4.3.0 or later</li></ul>
    </main>

* **Custom Remote Procedure Call (RPC) port**: allows you to specify a custom RPC port when you create an OBProxy cluster to implement direct load and OBKV.

    <main id="notice" type='explain'>
    <h4>Note</h4>
    The custom RPC port feature is supported only for OBProxy V4.3.0 and later.
    </main>

* **CPU core quantity statistics**: measures the quantities of CPU cores for clusters managed by OCP, excluding the MetaDB of the OCP cluster and the OceanBase clusters that are in the stopped state.

* **Host management**: allows you to add hosts after logon without using a password.

### Alert center

OCP V4.3.2 supports generating alerts for memory overrun of OBProxy. Specifically, an alert is generated when the memory usage reaches 85% or more.

### Performance monitoring

* OCP V4.3.2 supports monitoring the following metrics of OBKV-Table and OBKV-HBase instances: queries per second (QPS), response time, and average number of affected rows.
* OCP V4.3.2 supports displaying the response time at the 99th percentile and 95th percentile to help you better learn about the system performance.
* OCP V4.3.2 supports displaying the minute-level monitoring data of the log disk and data disk.

<main id="notice" type='explain'>
<h4>Note</h4>
<li>You can view the OBKV-Table and OBKV-HBase monitoring data only for a MySQL tenant that belongs to a cluster of OceanBase Database V3.2.4.4 or later. </li>
<li>You can view the 95-all and 99-all metrics only when the OceanBase Database version falls within the range [V4.2.1.7,V4.2.2.0), [V4.2.5.0,V4.3.0.0), or [V4.3.3.0,+∞). </li>
</main>

### OceanBase Autonomy Service

**SQL Diagnostics** > **SlowSQL**: OCP V4.3.2 supports displaying sample data and displaying detailed parameters of sample data on the details page.

### API operations

* OCP V4.3.2 provides nine API operations for tenants of OceanBase Database V4.x, including API operations for backing up data immediately, showing backup tasks, creating a backup strategy, modifying a backup strategy, querying backup strategies, and disabling a backup strategy.
* OCP V4.3.2 provides an API operation for enabling or disabling a backup strategy at the cluster level for OceanBase Database V3.x.
* OCP V4.3.2 provides an API operation for querying the last inspection result of an inspection object, such as a cluster, tenant, host, or OBProxy.
* OCP V4.3.2 provides 13 API operations for primary/standby tenant switchovers in OceanBase Database V4.x, including API operations for creating a network-based standby tenant, performing a switchover, and performing a failover.

### Platform capabilities

* The cluster takeover capability is improved to ensure that the config server can still provide external services during a takeover.
* The GUI of OCP is available (read-only) during an OCP upgrade.
* Parameter configuration management is supported for OCP Agent. Monitoring data collection can be dynamically controlled. This can reduce the pressure of the sys tenant when a large amount of data is to be collected in the case of exceptions.
* OpenID Connect (OIDC) and Open Authorization 2.0 (OAuth 2.0) are supported for single sign-on (SSO), addressing user-side configuration issues.

## Product optimizations

### Cluster management

* You can select a load type for a cluster of OceanBase Database V4.3.0 or later during cluster creation. The default load type is hybrid transaction/analytical processing (HTAP).
* You can specify the upgrade sequence of zones in a cluster to manually control the leader switching time, thereby minimizing the impact of leader switching on business.
* By default, the parameter settings of an existing OBServer node in the cluster are used for the new OBServer node by default.
* The credential export process during cluster move-out is optimized to reduce risks.

### Tenant management

* When you create a tenant in a cluster of OceanBase Database V4.3.0 or later, you can select a load type for the tenant, to improve the performance in online transaction processing (OLTP), online analytical processing (OLAP), HTAP, and OBKV business scenarios.
* A confirmation prompt is provided for tenant-level changes, to avoid exceptions caused by misoperations.
* You can view the resource usage limits for a tenant under the current resource specifications, such as the number of log streams and tablets.

    <main id="notice" type='explain'>
    <h4>Note</h4>
    You can view the resource usage limits for a tenant only if the cluster to which the tenant belongs meets the following version requirements:
    <ul><li>OceanBase Database V4.2.x: V4.2.4 or later</li><li>OceanBase Database V4.3.x: V4.3.1 or later</li></ul>
    </main>

* You can create and view database users with the hostname syntax in MySQL tenants.
* You can query sessions by session ID.

### Other optimizations

* **OBProxy**: You can copy the name of an OBProxy cluster.

* **Binlog service**: The binlog instance list can display standby instances, and allows you to restart and stop standby instances.

* **Task management**: The task node skip feature is optimized to avoid affecting the status of database objects.

* **Host management**: OCP V4.3.2 adds the following host standardization check items: Maximum Transmission Unit (MTU) size, Network Time Protocol (NTP), as well as kernel parameters `net.ipv4.ip_local_port_range` and `net.ipv4.ip_local_reserved_ports`.

## Product behavioral changes

**Backup and restore**: The step of installing the logical backup and restore service is removed from the installation wizard.

## Key features

### Tenant cloning

OceanBase Database tenants are similar to conventional database instances. OceanBase Database supports two types of tenants: MySQL tenants and Oracle tenants. With the tenant cloning feature, you can quickly copy the metadata of a source tenant to a new tenant (clone tenant). In the initial status, the two tenants share the same physical macroblocks. The new tenant and source tenant are independent of each other. Data and resources are isolated between the two tenants. Data changes in either tenant do not affect the other tenant.

It takes only 2 minutes to clone a source tenant with eight CPU cores, 64 GiB of memory, and 1 TiB data in a test environment. OCP also supports synchronizing source tenant parameters and performing resource checks to facilitate tenant cloning. This feature applies to business scenarios such as report tasks, application version releases, database changes, and data export, and can improve the task execution efficiency and reduce business risks in such scenarios.

### CPU core binding configuration

CPU core binding (taskset) is a technology that binds a specific process or thread to a specific CPU core. This way, key tasks are processed by fixed CPU cores, instead of being frequently switched from one core to another. CPU core binding reduces the context switching overhead and improves the overall system performance. You can enable or disable CPU core binding for OBProxy clusters and OceanBase clusters. According to onsite test data, CPU core binding can reduce the response time by 15% to 20% in a scenario where the OBProxy and OceanBase Database are deployed on the same ARM-based server.

However, excessive use of the technology may lead to a situation where some CPU cores are overloaded while others are idle, decreasing resource utilization in the system. You need to decide whether to use CPU core binding and adjust the core binding strategy based on your business conditions to achieve the optimal performance and resource utilization.

## Bug fixes

The following issues are fixed in OCP V4.3.2:

* Fixed the issue of incompatibility when you deploy two clusters with the same name in OCP.
* Fixed the issue where the connectable OceanBase clusters of an OBProxy started by using the RootService list cannot be taken over.
* Fixed the issue of tenant traffic monitoring exceptions during node replacement.
* Fixed the issue where a failover between the primary and standby OCP clusters fails in multi-cluster mode.
* Fixed the issue where querying top SQL statements based on parameters provided in the official site fails.
* Fixed the issue where the button for sorting clusters is invalid on the homepage of OceanBase Autonomy Service.

## Known issues

| No. | Known issue | Solution |
|-------|---------|---------------|
| 1 | If you create a username with a percent sign (`%`) or the `host_ip` string on the CLI in a MySQL tenant, an error occurs during O&M operations. | Do not create a username with a percent sign (`%`) on the CLI. |

# Limitations

## Hardware requirements

OCP-Server can be installed on a physical server or in a Docker container. OCP-Server supports the multi-node HA deployment mode.

The following table lists the minimum hardware requirements of an OCP-Server node.

| Hardware | Requirement |
|-------|------------------------------------|
| CPU | <li>x86_64 processor with 8 cores</li><li>ARM64 processor with 8 cores</li> |
| Memory | 16 GiB available memory |
| Network interface card (NIC) | 10 Gbit/s NIC |

OCP-Agent takes up few resources and has no special requirements for hardware.

## Operating system requirements

The following table lists the operating system requirements for installing OCP-Server (including OCP-Agent).

| Server architecture | Operating system | Supported version |
|-------------|------------|-----------|
| x86_64 | Red Hat Enterprise Linux (RHEL) | 7.2 and later |
| x86_64 | CentOS | 7.2 and later |
| x86_64 | AliOS | 7.2 and later |
| x86_64 | openSUSE | 12SP3 and later |
| ARM64 | AliOS | 7.2 and later |
| ARM64 | NeoKylin | 7.6 |
| ARM64 | Huawei EulerOS | 2.0 SP8 |
| x86_64 | Debian | Debian GNU/Linux 11 (bullseye) |
| x86_64 | Ubuntu | Ubuntu 18.04.6 LTS |

## Client requirements

Generally, users use browsers to access OCP. The following client requirements apply.

| Browser | Earliest supported version |
|---------|------|
| Chrome | 88 |
| Firefox | 78 |
| Safari | 14 |
| Edge | 88 |

If you need to access OCP from an iOS device, the iOS version must meet the requirement listed in the following table.

| Operating system | Earliest supported version |
|------|------|
| iOS | 10 |

We recommend that you use displays with a resolution greater than 1440 × 810 to ensure optimal use experience.
