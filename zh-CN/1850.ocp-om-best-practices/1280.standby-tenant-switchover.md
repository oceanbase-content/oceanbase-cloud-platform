# 备租户容灾切换

本节为您介绍如何进行主备租户的容灾切换。

## 应用场景

当主租户不可用时，将备租户通过容灾切换的方式切换为主租户，对外提供服务。

## 前提条件

下文中提到的备租户是指将要进行容灾切换的备租户，而主租户指的是备租户的主租户。在级联形式的主备租户关系中，例如 `租户 A` > `租户 B` > `租户 C`，`租户 B` 和 `租户 C` 的角色均为 standby。但在 `租户 C` 进行容灾切换时，本文会称 `租户 C` 为备租户，`租户 B` 为主租户，仅为了文章描述清晰。

* 主租户已经不可用（主租户可用的情况下，可以使用备租户解耦功能）。
* 主租户、备租户均已被 OCP 管理（OCP 多集群模式下，主备租户可以处于不同的 OCP 集群中）。
* 备租户可用，且备租户所处集群状态正常。

## 操作步骤

1. 登录 OCP。

2. 单击左侧导航栏 **租户** ，在 **租户列表** 中进入备租户。

3. 单击右上角更多图标，选择 **容灾切换** 。

   ![1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/420/%E5%AE%B9%E7%81%BE%E5%88%87%E6%8D%A2.png)

4. OCP 会列出主租户的所有备租户的一致点位情况，即可以理解为时间点最新的备租户拥有更新的数据。此时可以考虑使用一致点位最新的备租户进行容灾切换，操作同上。

   单击 **容灾切换**，提交运维任务，运维任务执行成功后，代表备租户容灾切换完毕。

   ![11221346](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/430/%E5%AE%B9%E7%81%BE%E5%88%87%E6%8D%A2.png)

## 常见问题

**OCP 中备租户容灾切换与主备解耦有什么区别？**

* 主备租户进行容灾切换时，OCP 会进行如下额外检查：

  1. 主备租户是否已被 OCP 管理。
  2. 主租户是否已经不可用。此检查是为了防止容灾切换后出现双主情况，从而导致上层业务出错。

* 当 [主备租户解耦](1290.primary-or-standby-tenant-decouple.md) 时，已经预期主租户不存在不可用的情况，此时 OCP 不会进行额外检查。
