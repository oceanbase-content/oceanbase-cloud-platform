# 创建 Binlog 集群

Binlog 集群是由一个或多个 Binlog Sever 组成的统一的对外服务，在 Binlog 集群中存在多台 Binlog Server 的场景下，租户 Binlog 服务启动时，将根据负载均衡的逻辑选择合适的 Binlog Server；当任意一台 Binlog Server 故障时，将由其他正常的 Binlog Server 接管其 Binlog 服务。

您可以根据业务需要新建待管理的 Binlog 集群。

<main id="notice" type='notice'>
<h4>功能适用性</h4>
<p>该内容仅适用于 OCP 企业版，OCP 社区版不支持此功能。</p>
</main>

## 前提条件

请确保当前登录用户拥有系统管理员（ADMIN）权限。

## 操作步骤

1. 登录 OCP，在左侧导航栏单击 **Binlog 服务** 。

2. 进入 Binlog **集群列表** 页面，单击右上角 **创建 Binlog 集群** 。

3. 在 **创建 Binlog 集群** 页面，设置集群基本信息。

     |配置  |   描述   |
     |-----|-------|
     | **Binlog 集群名**          | 自定义待管理的 Binlog 集群名称。集群名称必须以英文字母开头、英文或数字结尾，可包含英文、数字和下划线，且长度为 2 ~ 32 字符。|
     | **软件版本**         | 选择 Binlog 集群的软件包版本。若列表中无可用软件包，您可单击列表下方 **上传软件包** 进行上传。  |
     | **访问地址**          | 填写 Binlog 集群的访问地址，用于 OBProxy 与当前 Binlog 集群通信的请求转发和负载均衡。   |
     | **访问端口** | Binlog 集群的访问端口，默认为 **2983**，支持自定义。   |

     ![Image 175](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/431/%E5%88%9B%E5%BB%BA%E9%9B%86%E7%BE%A4-%E5%9F%BA%E6%9C%AC%E8%AE%BE%E7%BD%AE.png)

4. 配置 MetaDB 信息。

   需要您输入 MySQL 租户的相关信息，用于存储 Binlog Service 的元信息，建议您不要使用业务集群。

     |配置  |   描述   |
     |-----|-------|
     | **集群名**    | 选择已有的 OceanBase 集群作为 Binlog Service 的 MetaDB。|
     | **租户名**    | 选择集群中具体的 MySQL 租户。   |
     | **数据库用户名**        | 选择 MySQL 租户下具体的用户。  |
     | **数据库名称**          | 填写 MetaDB 数据库的名称，默认为 `binlog_database`，支持自定义。   |

   ![10](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/431/%E5%88%9B%E5%BB%BA%E9%9B%86%E7%BE%A4-metadb%E8%AE%BE%E7%BD%AE.png)

5. 部署 Binlog 集群。

   每个 Binlog 集群由多个 Binlog Server 组成，每个 Binlog Server 需要设置的信息及其说明如下。

   |   配置   |  描述   |
   |-----|-------|
   | **机房**     | Binlog Server 所在的机房，一个 Binlog Server 只能存在于一个机房。  |
   | **机型**    | 可选项。如果选择了机型，后面主机列表会根据机型进行过滤。   |
   | **主机**  | 您可以选择多个主机，或进行添加主机的操作。   |

   ![1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/431/%E5%88%9B%E5%BB%BA%E9%9B%86%E7%BE%A4-%E9%83%A8%E7%BD%B2binlog%E9%9B%86%E7%BE%A4.png)

6. 在 **参数设置** 模块，逐个添加启动参数项并为其配置值。

    ![09161737](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/431/%E5%88%9B%E5%BB%BA%E9%9B%86%E7%BE%A4-%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE.png)

7. 在 **自定义设置** 模块，支持您自定义软件安装路径。路径默认为 `/home/admin/binlogservice`，支持自定义。

   ![1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/431/%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AE%BE%E7%BD%AE.png)

8. 单击 **提交** 。

9. 创建集群任务提交后，您可在 **任务中心** 中查看该任务的执行进度。

## 集群列表总览

集群创建完成后，您可在 **集群列表** 中查看 Binlog 集群的相关信息，包括 **Binlog 集群名**、**状态**、**已分配 CPU**、**已分配内存**、**已使用数据盘**、**版本号**、**创建时间** 和 **修改时间** 。

* 单击集群名，可跳转至 Binlog 集群概览页面，详情参见 [查看 Binlog 集群概览](300.manage-a-binlog-cluster/100.binlog-cluster-overview.md)。
* 支持通过 **状态** 对 Binlog 集群进行筛选。
