# 查询 OceanBase 集群的 Unit 列表

## 功能说明

该接口用于查询 OceanBase 集群的 Unit 列表。

## 调用说明

### 接口约束

调用者需要通过 OCP 应用服务鉴权。

### 请求路径

`GET /api/v2/ob/clusters/{id}/units`

### 请求参数

Path 参数：

|  参数  |  类型  |  必选  | 示例值 |  描述  |
|----|----|----|-----|----|
|  id  |  Integer  |  是  | 1   |  集群ID  |

### 返回结果

基础数据结构

|  参数  |  类型  | 说明                               |
|----|----|----------------------------------|
|  data  |  Object  | UnitInfo 的信息，详情参见下表。 |
|  successful  |  Boolean | 请求是否成功。                          |
|  timestamp |  Datetime  | 服务端完成请求的时间戳。                     |
|  duration |  Integer  | 服务端处理请求的时间（毫秒）。                  |
|  status |  Integer  | 符合 HTTP Status 规范的编码。            |
|  traceId |  String  | 请求的 Trace ID，用于排查问题。             |
|  server  |  String  | 响应请求的应用服务的地址。                    |

`UnitInfo` 的数据结构

|  参数  |  类型  |  说明  |
|----|----|----|
|  obUnitId  |  Integer  |  Unit ID  |
|  tenantId  |  Integer  |  租户 ID  |
|  tenantName  |  String  |  租户名  |
|  obTenantId  |  Integer  |  OceanBase 侧租户 ID  |
|  svrIp  |  String  |  OBServer IP  |
|  svrPort  |  Integer  |  OBServer 端口  |
|  zone  |  String  |  Zone 名  |
|  unitConfig  |  UnitConfig  |  Unit 规格，详情参见下表  |
|  status  |  String  |  Unit 状态  |
|  migrateType  |  String  |  Unit 迁移类型  |
|  migrateOppositeSvrIp  |  String  |  迁移对端 OBServer IP  |
|  migrateOppositeSvrPort  |  Integer  |  迁移对端 OBServer 端口  |
|  manualMigrate  |  Boolean  |  是否为手工迁移  |
|  logDiskUsedByte  |  Integer  |  日志盘使用量，单位 byte，仅适用于 OceanBase 4.0 及以上版本  |
|  dataDiskUsedByte  |  Integer  |  数据盘使用量，单位 byte，仅适用于 OceanBase 4.0 及以上版本  |

`UnitConfig` 的数据结构

|  参数  |  类型  |  说明  |
|----|----|----|
|  maxCpuCoreCount  |  Number  |  最大 CPU 核数  |
|  minCpuCoreCount  |  Number  |  最小 CPU 核数  |
|  maxMemoryByte  |  Integer  |  最大内存大小，单位 byte  |
|  minMemoryByte  |  Integer  |  最小内存大小，单位 byte  |
|  logDiskSizeByte  |  Integer  |  日志盘大小，单位 byte  |
|  maxIops  |  Integer  |  最大 IOPS  |
|  minIops  |  Integer  |  最小 IOPS  |
|  iopsWeight  |  Integer  |  IOPS 权重  |
|  logDiskSize  |  Integer  |  日志盘大小，单位 GB  |
|  minMemorySize  |  Integer  |  最小内存大小，单位 GB  |
|  maxMemorySize  |  Integer  |  最大内存大小，单位 GB  |

## 示例

### 请求示例

`GET /api/v2/ob/clusters/{id}/units`

### 返回示例

```JSON
{
  "data": {
    "contents": [
        {
            "dataDiskUsedByte": 79691776,
            "logDiskUsedByte": 662790112,
            "obTenantId": 1,
            "obUnitId": 1,
            "status": "ACTIVE",
            "svrIp": "xxx.xxx.xxx.xxx",
            "svrPort": 2882,
            "tenantId": 5883,
            "tenantName": "sys",
            "unitConfig": {
                "iopsWeight": 2,
                "logDiskSize": 8,
                "logDiskSizeByte": 8589934592,
                "maxCpuCoreCount": 2.00,
                "maxIops": 0,
                "maxMemoryByte": 5368709120,
                "maxMemorySize": 5,
                "minCpuCoreCount": 2.00,
                "minIops": 0,
                "minMemoryByte": 5368709120,
                "minMemorySize": 5
            },
            "zone": "zone1"
        }
      ]
  },
  "duration": 284,
  "server": "xxx.xxx.xxx.xxx",
  "status": 200,
  "successful": true,
  "timestamp": "2024-04-10T10:39:43.33+08:00",
  "traceId": "xyz"
}
```

