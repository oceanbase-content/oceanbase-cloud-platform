# 针对特定类型的对象发起特定场景的巡检

## 功能说明

该接口用于针对指定对象发起某个场景的巡检。

## 调用说明

### 接口约束

调用者需要通过 OCP 应用服务鉴权。

### 请求路径

`POST /api/v2/inspection/run`

### 请求参数

|  参数  |  类型  |  必选  |  示例值  |  描述  |
|--------|--------|--------|----------|--------|
|  inspectionObjectType  |  String  |  是  |  OB_CLUSTER  |  巡检对象类型，包括：<li>OB_CLUSTER：集群。</li><li>OB_TENANT：租户。</li><li> HOST：主机。</li><li> OB_PROXY：OBproxy。</li> |
|  objectIds  |  Array  |  是  |  1002  |  巡检对象在 OCP 中的 ID，如集群 ID、租户 ID，多个 ID 时使用 `,` 分隔。 |
|  tags  |  Integer  |  是  |  1  |  场景标签，标签 ID 如下：<li>1：基础巡检。</li><li>2：性能巡检。</li><li>3：深度巡检。</li><li>4：装机巡检。</li> |

### 返回结果

基础数据结构

|  参数  |  类型  |  说明  |
|--------|--------|--------|
|  data  |  Object  |  异步任务信息，详情参见 [任务信息](../400.task-return-structure.md)。  |
|  successful  |  Boolean |  请求是否成功。 |
|  timestamp |  Datetime  |  服务端完成请求的时间戳。  |
|  duration |  Integer  |  服务端处理请求的时间（毫秒）。  |
|  status |  Integer  |  符合 HTTP Status 规范的编码。  |
|  traceId |  String  |  请求的 Trace ID，用于排查问题。  |
|  server  |  String  |  响应请求的应用服务的地址。  |

## 示例

### 请求示例

`POST /api/v2/inspection/run`

### 返回示例

```JSON
{
    "data": {
        "contents": [
            {
                "creator": "admin",
                "executor": "xxx.xxx.xxx.xxx",
                "id": 6058460,
                "name": "Inspection task",
                "operation": "EXECUTE",
                "prohibitRollback": false,
                "startTime": "2024-07-30T14:03:41.269+08:00",
                "status": "RUNNING",
                "subtasks": [
                    {
                        "description": "Manual inspection task",
                        "downstreams": [],
                        "id": 6062131,
                        "name": "Manual inspection task",
                        "nodeType": "JAVA_TASK",
                        "operation": "EXECUTE",
                        "parallelIdx": -1,
                        "prohibitRollback": false,
                        "runTime": 1,
                        "seriesId": 0,
                        "status": "READY",
                        "timeout": 7200,
                        "upstreams": []
                    }
                ],
                "taskDefinitionId": -1,
                "type": "SCHEDULED"
            }
        ]
    },
    "duration": 93,
    "server": "124075fe52",
    "status": 200,
    "successful": true,
    "timestamp": "2024-07-30T14:03:41.316+08:00",
    "traceId": "ec5ce7cbd4403746"
}
```
