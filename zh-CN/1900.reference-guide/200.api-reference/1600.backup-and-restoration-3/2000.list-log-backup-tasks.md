# 查看租户日志备份任务

## 功能说明

该接口用于查看租户日志备份任务。

## 调用说明

### 接口约束

调用者需要通过 OCP 应用服务鉴权。

### 请求路径

`GET /api/v2/ob/clusters/{id}/tenants/{tenantId}/backup/task/logBackupTasks`

### 请求参数

**Path 参数**

|  参数      |  类型     |  必选  |  示例值  |  描述       |
|------------|-----------|--------|----------|-------------|
|  id        |  Integer  |  是    |  1002    |  集群 ID。  |
|  tenantId  |  Integer  |  是    |  108     |  租户 ID。  |

**Query 参数**

|  参数       |  类型    |  必选  |  示例值                    |  描述     |
|-------------|----------|--------|----------------------------|------------|
|  startTime      |  String  |  否     |  2024-08-06T00:00:00Z       |   开始时间，该时间只支持 UTC 时间，格式为：YYYY-MM-DDThh:mm:ssZ。         |
|  endTime        |  String  |  否     |  2024-08-07T00:00:00Z       |   结束时间，该时间只支持 UTC 时间，格式为：YYYY-MM-DDThh:mm:ssZ。         |
|  status     |  Array   |  否    |  STARTING                  |  任务状态，包括：<li>STARTING：启动中。 </li><li> INPROGRESS：进行中。 </li><li> STOPPING：停止中。 </li><li> STOPPED：已停止。 </li><li> FAILED：失败。 </li><li> INTERRUPTED：已中断。 </li><li> UNKNOWN：未知。 </li>  |

### 返回结果

**基础数据结构**

|  参数  |  类型  | 说明                               |
|---------|----------|----------------------------------|
|  data  |  Object  | 详情参见 **`LogBackupWrapperTask` 的数据结构**。 |
|  successful  |  Boolean | 请求是否成功。                          |
|  timestamp |  Datetime  | 服务端完成请求的时间戳。                     |
|  duration |  Integer  | 服务端处理请求的时间（毫秒）。                  |
|  status |  Integer  | 符合 HTTP Status 规范的编码。            |
|  traceId |  String  | 请求的 Trace ID，用于排查问题。             |
|  server  |  String  | 响应请求的应用服务的地址。                    |

**`LogBackupWrapperTask` 的数据结构**

|     参数    |    类型   |            说明            |
|-------------|-----------|--------------------------|
| backupDimension       | String  | 备份维度，如 CLUSTER 代表集群备份，TENANT 代表租户备份。 |
| createTime  | Timestamp | 创建时间。                    |
| modifyTime  | Timestamp | 修改时间。                    |
| clusterName | String    | 集群名。                     |
| clusterId   | Long      | 集群 ID。                   |
| obClusterId | Long      | OceanBase 集群 ID。                |
| obTenantId  | Long      | OceanBase 侧租户 ID。               |
| clusterType | String    | 集群类型，包括：<li>PRIMARY：主集群。</li><li>STANDBY：备集群。</li> |
| tenantId    | Long      | 租户 ID。                   |
| tenantName  | String    | 租户名。                     |
| status      | String    | 状态。                      |
| errorMsg    | String    | 错误信息。                    |
| backupUri   | String    | 备份路径。                    |
| checkpoint  | Timestamp | 最新位点。                    |
| backupMode  | String    | 备份模式。                    |
| delay       | Long      | 日志延迟，单位为秒。               |

## 示例

### 请求示例

`GET /api/v2/ob/clusters/1000005/tenants/1000012/backup/task/logBackupTasks?page=1&size=10`

### 返回示例

```JSON
{
  "data": {
    "contents": [
      {
        "agentServerIp": "xxx.xxx.xxx.xxx",
        "backupDimension": "TENANT",
        "backupMode": "PHYSICAL_BACKUP",
        "backupUri": "file:///obbackup",
        "checkpoint": "2024-08-09T16:04:21.810084+08:00",
        "clusterId": 1000005,
        "clusterName": "ob_431",
        "clusterType": "PRIMARY",
        "createTime": "2024-08-09T15:58:21.716899+08:00",
        "delay": 100.1899,
        "obClusterId": 199,
        "obTenantId": 1050,
        "status": "RUNNING",
        "tenantId": 1000012,
        "tenantName": "ww1144"
      }
    ],
    "page": {
      "number": 1,
      "size": 10,
      "totalElements": 1,
      "totalPages": 1
    }
  },
  "duration": 79,
  "server": "a24d13ce67",
  "status": 200,
  "successful": true,
  "timestamp": "2024-08-09T16:06:02.743+08:00",
  "traceId": "8e1e79e260d12bba"
}
```
