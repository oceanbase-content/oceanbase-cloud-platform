<a name="v6PG3"></a>
## 恢复预览
<a name="wTbCZ"></a>
### 功能说明
该接口用于预览恢复任务，返回所有备份资源的路径。
<a name="gElx0"></a>
### 调用说明

#### 接口约束

- 调用者需对恢复的目标集群有租户创建的权限。
<a name="D4zjf"></a>

#### 请求路径
`POST /api/v2/ob/clusters/{id}/backup/restore/preview`
<a name="u9e05"></a>

#### 请求参数
<a name="nYy4U"></a>


| 参数 | 类型 | 必选 | 示例值 | 描述 |
| --- | --- | --- | --- | --- |
| id | Integer | 是 | 1001 | 已备份集群的 ID。 |

**RestoreTenantParam的数据结构**

| 参数 | 类型 | 必选 | 说明 |
| --- | --- | --- | --- |
| backupTenantStatus | String | 是 | 备份租户的状态，在线(ONLINE) 或者 离线(OFFLINE)。 |
| restoreOnlineTenantRequiredParam | Object | 否 | 当备份租户是在线时，该参数为必选。 |
| &#124;----backupClusterId | Long | 是 | 备份集群 ID。 |
| &#124;----backupTenantId | Long | 是 | 备份租户 ID。 |
| &#124;----restoreClusterId | Long | 是 | 恢复集群 ID。 |
| &#124;----restoreEndTime | OffsetDateTime | 是 | 恢复到某个时刻。 |
| &#124;----restoreTenantInfoParam | Object | 是 | 恢复的目标租户模型。 |
| &#124;----name | String | 是 | 租户名。 |
| &#124;----primaryZone | String | 否 | 主可用区。 |
| &#124;----zones | Arrays | 是 | Zone 配置。 |
| &#124;----name | String | 是 | Zone 名。 |
| &#124;----replicaType | String | 是 | 副本类型，包括FULL,LOGONLY、READONLY。 |
| &#124;----resourcePool | Object | 是 | 资源池配置。 |
| &#124;----unitSpecName | String | 是 | 规格名。 |
| &#124;----unitCount | Long | 是 | 规格数目。 |
| restoreOfflineTenantRequiredParam | Object |  | 当备份租户是离线时，该参数为必选。 |
| &#124;----backupMode | String | 是 | 备份方式。 |
| &#124;----backupClusterName | String | 是 | 备份集群名。 |
| &#124;----backupObClusterId | Long | 否 | 备份集群 ID（OceanBase 侧）。 |
| &#124;----backupTenantName | String | 是 | 备份租户名。 |
| &#124;----backupObTenantId | Long | 否 | 备份租户 ID (OceanBase 侧)。 |
| &#124;----restoreClusterId | Long | 是 | 恢复集群 ID。 |
| &#124;----obBackupStorageBaseInfo | Object | 是 | 备份存储信息，参照 [创建集群的备份策略](https://www.oceanbase.com/docs/common-ocp-1000000000585304)<br /> 中的具体数据结构。 |
| &#124;----restoreEndTime | OffsetDateTime | 是 | 恢复到某个时刻。 |
| &#124;----restoreTenantInfoParam | Object | 是 | 恢复的目标租户模型，同在线恢复中的模型。 |

<a name="Pk6D5"></a>

#### 返回结果
| 参数 | 类型 | 说明 |
| --- | --- | --- |
| data | Array | 详见 **RestorePreviewItem 的数据结构** 。 |
| successful | Boolean | 请求是否成功。 |
| timestamp | Datetime | 服务端完成请求的时间戳。 |
| duration | Integer | 服务端处理请求的时间（毫秒）。 |
| status | Integer | 符合 HTTP Status 规范的编码。 |
| traceId | String | 请求的 Trace Id，用于排查问题。 |
| server | String | 响应请求的应用服务的地址。 |

**RestorePreviewItem 的数据结构**

| 参数 | 类型 | 说明 |
| --- | --- | --- |
| backupDest | String | 备份路径。 |
| backupId | Long | 备份ID。 |
| backupType | String | 备份集或者备份切片。 |
| copyId | Long | 拷贝ID。 |

<a name="ibIH2"></a>
### 示例

#### 请求示例
```json
{
  "backupTenantStatus": "ONLINE",
  "restoreOnlineTenantRequiredParam": {
    "restoreClusterId": 14,
    "backupClusterId": 14,
    "backupTenantId": 280,
    "restoreEndTime": "2024-04-06T14:16:02.000000+08:00",
    "restoreTenantInfoParam": {
      "name": "test1",
      "zones": [{
        "key": "15",
        "checked": true,
        "name": "zone1",
        "replicaType": "FULL",
        "resourcePool": {
          "unitSpecName": "S1",
          "unitCount": 1
        }
      }],
      "primaryZone": "zone1",
      "tableRestoreObjects": []
    }
  }
}
```
<a name="Jd8MY"></a>

#### 返回示例<br /><br />
```json
{
  "data": {
    "contents": [
      {
        "backupDest": "file:///obbackup/backup_3245/1704259760/incarnation_1/1002/data/backup_set_24_full_20240406",
        "backupId": "24",
        "backupType": "BACKUP_SET",
        "copyId": "0"
      },
      {
        "backupDest": "file:///obbackup/backup_3245/1704259760/incarnation_1/1002/clog/6_38_20240405",
        "backupId": "38",
        "backupType": "BACKUP_PIECE",
        "copyId": "0"
      }
    ]
  },
  "duration": 117,
  "server": "d21b8dbaea",
  "status": 200,
  "successful": true,
  "timestamp": "2024-04-25T19:12:16.452+08:00",
  "traceId": "596d720b94a542a6"
}
```
