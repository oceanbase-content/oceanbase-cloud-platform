# 日志盘

本节为您介绍 OceanBase 租户的监控指标 **日志盘** 。您可指定统计范围，查询租户在单个 Zone 或 OBServer 节点的 **日志盘** 数据。

## log_disk_size

### 指标介绍

统计范围内，租户日志盘分配大小。

### 指标参数说明

|   **指标项**   |         **指标名称**          | **单位** |
|-------------|-----------------------|--------|
|  log_disk_size | ob_tenant_log_disk_size | Byte      |

### 计算表达式

sum(ob_tenant_log_disk_total_bytes{@LABELS}) by (@GBLABELS)

### 采集 SQL

OceanBase V4.0 及以上版本：

```sql
SELECT T1.UNIT_ID, T1.SVR_IP, T1.SVR_PORT, T3.TENANT_ID, T3.TENANT_NAME, T1.LOG_DISK_SIZE, T1.LOG_DISK_IN_USE FROM (SELECT UNIT_ID, SVR_IP, SVR_PORT, SUM(LOG_DISK_SIZE) AS LOG_DISK_SIZE, SUM(LOG_DISK_IN_USE) AS LOG_DISK_IN_USE FROM V$OB_UNITS GROUP BY UNIT_ID) T1 JOIN DBA_OB_UNITS T2 JOIN (SELECT TENANT_ID, TENANT_NAME FROM DBA_OB_TENANTS WHERE TENANT_TYPE IN ('SYS', 'USER')) T3 ON T1.UNIT_ID = T2.UNIT_ID AND T2.TENANT_ID = T3.TENANT_ID
```

## log_disk_used

### 指标介绍

统计范围内，租户日志盘使用大小。

### 指标参数说明

|   **指标项**   |         **指标名称**          | **单位** |
|-------------|-----------------------|--------|
|  log_disk_used | ob_tenant_log_disk_used | Byte      |

### 计算表达式

sum(ob_tenant_log_disk_used_bytes{@LABELS}) by (@GBLABELS)

### 采集 SQL

OceanBase V4.0 及以上版本：

```sql
SELECT T1.UNIT_ID, T1.SVR_IP, T1.SVR_PORT, T3.TENANT_ID, T3.TENANT_NAME, T1.LOG_DISK_SIZE, T1.LOG_DISK_IN_USE FROM (SELECT UNIT_ID, SVR_IP, SVR_PORT, SUM(LOG_DISK_SIZE) AS LOG_DISK_SIZE, SUM(LOG_DISK_IN_USE) AS LOG_DISK_IN_USE FROM V$OB_UNITS GROUP BY UNIT_ID) T1 JOIN DBA_OB_UNITS T2 JOIN (SELECT TENANT_ID, TENANT_NAME FROM DBA_OB_TENANTS WHERE TENANT_TYPE IN ('SYS', 'USER')) T3 ON T1.UNIT_ID = T2.UNIT_ID AND T2.TENANT_ID = T3.TENANT_ID
```

## log_disk_used_percentage

### 指标介绍

统计范围内，租户日志盘使用百分比。

### 指标参数说明

|   **指标项**   |         **指标名称**          | **单位** |
|-------------|-----------------------|--------|
|  log_disk_used_percentage | ob_tenant_log_disk_used_percentage | %      |

### 计算表达式

100 * (sum(ob_tenant_log_disk_used_bytes{@LABELS}) by (@GBLABELS) / sum(ob_tenant_log_disk_total_bytes{@LABELS}) by (@GBLABELS))

### 采集 SQL

OceanBase V4.0 及以上版本：

```sql
SELECT T1.UNIT_ID, T1.SVR_IP, T1.SVR_PORT, T3.TENANT_ID, T3.TENANT_NAME, T1.LOG_DISK_SIZE, T1.LOG_DISK_IN_USE FROM (SELECT UNIT_ID, SVR_IP, SVR_PORT, SUM(LOG_DISK_SIZE) AS LOG_DISK_SIZE, SUM(LOG_DISK_IN_USE) AS LOG_DISK_IN_USE FROM V$OB_UNITS GROUP BY UNIT_ID) T1 JOIN DBA_OB_UNITS T2 JOIN (SELECT TENANT_ID, TENANT_NAME FROM DBA_OB_TENANTS WHERE TENANT_TYPE IN ('SYS', 'USER')) T3 ON T1.UNIT_ID = T2.UNIT_ID AND T2.TENANT_ID = T3.TENANT_ID
```
