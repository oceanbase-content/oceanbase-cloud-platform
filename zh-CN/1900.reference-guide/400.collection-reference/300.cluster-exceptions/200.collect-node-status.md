# 采集集群 server 节点信息

## 采集描述

查看是否存在坏盘，返回结果为空则表示没有标记为坏盘的磁盘。

## 采集原理

```SQL
SELECT /*+READ_CONSISTENCY(WEAK),query_timeout(100000000)*/ *
FROM __all_server
WHERE status = "active"
	OR start_service_time = 0
	OR stop_time > 0;
```

## 操作

* 系统表 `__all_server` 中显示 stop_time 不为 0，但 status 为 active，说明 observer 进程存在，但不能提供服务，处于 stop 状态。
* 启动的 OBServer 与 RootService 建立心跳，此时 OceanBase 数据库会将该 OBServer 的状态标记为 ACTIVE。

此时，查询 `__all_server` 虚拟表，可以观察到启动的 OBServer 状态为 ACTIVE，但 start_service_time 为 0，具体如下所示。

```sql
obclient> select svr_ip,status,start_service_time from __all_server;
+----------------+--------+--------------------+
| svr_ip         | status | start_service_time |
+----------------+--------+--------------------+
| xxx.xx.xxx.1 | active |                  0 |
| xxx.xx.xxx.2 | active |   1617702133437712 |
| xxx.xx.xxx.3 | active |   1617702146772849 |
+----------------+--------+--------------------+
3 rows in set (0.00 sec)
```
