# 采集集群 Zone 合并状态信息

## 采集描述

查看指定集群中 Zone 的合并状态。

## 采集原理

OceanBase V4.0.0 之前版本：

```sql
SELECT zone, info as status, gmt_modified from __all_zone WHERE name='merge_status' AND zone != '';
```

OceanBase V4.0.0 及后版本：

```sql
SELECT c.TENANT_ID tenant_id, t.tenant_name, c.ZONE zone, c.STATUS status, c.LAST_FINISH_TIME, c.IS_ERROR, c.INFO
FROM CDB_OB_ZONE_MAJOR_COMPACTION c
INNER JOIN __all_tenant t ON c.tenant_id=t.tenant_id;
```

## 处理方法

根据 Zone 的状态，排查是否有非 IDLE 合并状态，合并状态含义如下：

* IDLE：表示未进行合并。
* ERROR：表示合并出错。
* TIMEOUT：表示合并超时，但是合并仍然继续不会暂停，仅设置超时标志。
* MERGING：表示正在进行合并。

对于 `STATUS` 列为 `IDLE` 对应行，其 `gmt_modified` 列值表示最近一次合并的完成时间。
