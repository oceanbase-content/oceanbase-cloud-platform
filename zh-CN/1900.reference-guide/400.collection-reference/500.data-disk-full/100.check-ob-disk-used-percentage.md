# 采集集群中节点数据盘使用率情况

## 采集描述

查看指定集群按节点统计数据盘的使用率情况，包含总分配大小、已使用大小、剩余可用大小等。

## 采集原理

```sql
SELECT b.zone, a.svr_ip, a.svr_port,
        ROUND(a.total_size/1024/1024/1024,3) total_size_GB,
        ROUND((a.total_size-a.free_size)/1024/1024/1024,3) used_size_GB,
        ROUND(a.free_size/1024/1024/1024,3) free_size_GB,
        ROUND((a.total_size-a.free_size)/total_size,2)*100 disk_used_percentage
FROM __all_virtual_disk_stat a
INNER JOIN __all_server b
  ON a.svr_ip=b.svr_ip AND a.svr_port=b.svr_port
ORDER BY zone
```

## 可能的影响

数据盘写满后可能会导致无法转储、无法合并、内存无法释放等问题，进而导致集群无法写入。
