# OCP V4.3.3

OCP V4.3.3 正式发布，可全面兼容 OceanBase V4.2.5 与 V4.3.3 版本。本版本增添了关键功能——列存副本，特别适用于 TP/AP 负载需强物理隔离的业务场景。同时，本版本还支持统计信息管理，有助于用户优化数据库查询性能，确保系统稳定运行。此外，本版本还提供了库表级别恢复能力，在基础运维、性能监控、巡检服务、平台功能等方面包含了 20 多项改进和优化，有效地解决了数据库运维及管控工具本身的易用性和稳定性问题，助力用户更简便高效地管理 OceanBase 数据库。

## 版本信息

* **版本号：** V4.3.3

* **前置版本：** V4.3.2 BP1

* **版本发布日期：** 2024 年 11 月 28 日

* **支持的升级路径：**

  * 目前仅支持从 OCP V3.2.4 及之后版本直接升级到当前版本。

  * 对于 OCP V2.3.x 及之后、V3.2.4 之前的版本，需先升级至 OCP V3.3.4 版本。

  * 对于 OCP V2.3.0 之前版本，需先升级至 OCP V2.3.x 版本，再升级到 OCP V3.3.4 版本。

## 支持的 OceanBase 数据库版本

OCP V4.3.3 版本支持下表所列版本的 OceanBase 数据库。

* OceanBase V4.x
* OceanBase V3.2.x
* OceanBase V3.1.x
* OceanBase V2.2.x
* OceanBase V2.1.x
* OceanBase V1.4.x

## 产品新特性

### 基础运维

* **列存副本（实验特性）**：在新建租户或新增副本场景下，支持租户级别设置 Zone 的副本类型为只读列存型副本，适用于 TP/AP 负载强物理隔离的业务场景 (限制：OceanBase 版本>= 4.3.3 以及部署独立的 OBProxy 集群访问列存副本 ）

    <main id="notice" type='explain'>
    <h4>说明</h4>
    只读列存型副本具有如下限制条件：
    <ul><li>OceanBase 为 V4.3.3 及以上版本。</li><li>已部署独立的 OBProxy 集群来访问列存副本。</li></ul>
    </main>

* **统计信息管理**：支持统计信息运维窗口管理、收集库/表级别统计信息、锁定统计信息，展示 Top 10 DML 变更表等功能。

    <main id="notice" type='explain'>
    <h4>说明</h4>
    仅 OceanBase V4.0.0 及以上版本支持统计信息管理功能。
    </main>

* **租户合并**：支持租户暂停合并以及恢复合并功能，实现用户控制合并进程，避免因数据合并对业务造成影响。

* **编辑 Zone 属性**：支持修改 Zone 的 Region（区域）/机房信息。

* **日志服务**：

  * 支持展示 Binlog 实例、BinlogServer 的日志。
  * 支持白屏展示 OBServer 的日志文件 `alert.log`，通过日志规范化输出提升用户使用体验。

    <main id="notice" type='explain'>
    <h4>说明</h4>
    仅 OceanBase V4.2.5 及以上版本支持白屏查看 `alert.log`。
    </main>

### 性能监控

* **集群/租户 > 性能监控**：新增支持 Unit 级别监控，方便用户快速查看特定租户在某一特定主机上的监控指标。

* **租户 > 性能监控**：

  * 支持并行执行工作线程（PX 线程数）使用率监控，方便用户依据实际情况变更相关参数，进而满足业务需要。
  * 支持 OBKV-Table、OBKV-HBase 监控指标以及响应时间（RT） P99/P95 百分位统计展示，帮助用户更好地了解系统的性能状况。

        <main id="notice" type='explain'>
        <h4>说明</h4>
        仅 OceanBase V4.2.5 及以上版本支持查看如上监控指标。
        </main>

  * 支持展示表 Leader（包含全局索引）、副本数（包含只读副本、列存只读副本）、日志流 leader 数，方便用户观测数据库对象增长趋势。

* **租户 > 资源管理**：支持展示数据盘、日志盘增长趋势。

### 巡检服务

支持当 NFS 作为备份目录时进行 mount 参数检查，如版本、Sync、lookupcache 等。

### 备份恢复

* 支持物理库表级别恢复。

     <main id="notice" type='explain'>
     <h4>说明</h4>
     仅 OceanBase V4.x 版本支持物理库表级别恢复。
     </main>

* 备份恢复支持 HTTP 协议访问对象存储，如 S3、COS、OSS 等。

### 平台能力

* 扩展操作审计范围，记录 OCP 产品范围内的全部变更操作，方便用户基于审计记录进行安全审查。
* 支持接管通过 OBD 部署的 OBProxy 集群。
* 优化 OCP 多集群部署时主备集群的切换时间，由 2 分钟缩减至秒级别（10 秒之内）。

## 产品优化

### 集群管理

* Cgroup 开启预期有 7% 左右性能损耗，支持用户依据业务场景在集群创建和运行期间开启和关闭 Cgroup。
* 集群列表页取消展示 CPU 架构。
* 支持创建集群时选择负载类型，默认为 HTAP。实现 4 种业务场景下如 OLTP、HTAP、OBKV 等性能最优化。

     <main id="notice" type='explain'>
     <h4>说明</h4>
     仅 OceanBase V4.2.5 及以上版本支持配置负载类型。
     </main>

* 支持在数据盘和日志盘 IOPS 不足时进行提示：为了保障 OceanBase 稳定运行，建议您使用 SSD 类型磁盘，若您使用 HDD 类型磁盘，请确保数据盘  IOPS 大于1000， 日志盘 IOPS 大于 2000，否则系统极易出现线程积压、打爆 CPU/ IO 等情况，造成业务影响。
* 支持在 OceanBase 和 OBProxy 集群共享相同主机时进行提示：在迁出场景下，请您务必遵守如下顺序：1）迁出 OBProxy 集群；2）迁出 OceanBase 集群；3）接管 OceanBase 集群 ；4）接管 OBProxy 集群。

### 租户管理

* 支持租户列表展示租户真实 ID。
* 支持创建租户时选择负载类型，实现 4 种业务场景下如 OLTP、HTAP、OBKV 等性能最优化。

     <main id="notice" type='explain'>
     <h4>说明</h4>
     仅 OceanBase V4.2.5 及以上版本支持配置负载类型。
     </main>

### 其他

* 告警中心：
  * 备份恢复容量超出限制告警增加展示集群名称信息。
  * 新建 OCP 集群默认关闭 15 个告警，主要涉及 SQL 性能告警、`observer.log` 告警及运维操作提示类告警。
* 实现主机管理与任务中心跳转至 Binlog 集群，以及 Binlog 集群与实例跳转至任务中心，方便用户进行信息查看。

## 产品行为变更

**备份恢复**：安装向导中去除安装逻辑备份恢复服务步骤。

## 关键特性解读

### 只读列存副本（实验特性）

OceanBase 推出全新部署形态，支持在原有集群基础上，扩展单独 Zone 存放只读列存副本，类似 3+1 Zone 部署形式。该 Zone 上所有用户表均为列存格式存储，AP 类业务可通过独立 OBProxy 集群访问列存副本进行弱读方式的查询分析，不影响原 TP 业务，特别适用于 TP/AP 负载需强物理隔离的业务场景。OCP 支持用户在创建租户时选择特定 Zone 作为只读列存副本以及在租户正常运行时添加只读列存副本，同时提供主备租户场景下只读列存副本管理能力，帮助用户更方便、快捷的使用列存副本能力。

<main id="notice" type='explain'>
<h4>说明</h4>
<ul><li>只读列存型副本具有如下限制条件：<ul><li>OceanBase 为 V4.3.3 及以上版本。</li><li>OBProxy 为 V4.3.2 及以上版本。</li></ul></li></ul><ul><li>只读列存副本所使用的 OBProxy 集群参数需要特殊配置，详情可咨询 OCP 技术支持。</li></ul>
</main>

### 统计信息管理

OceanBase 查询优化器依据数据库统计信息来评估执行计划成本，这直接关乎查询效率，是系统快速响应与低延迟特性的基础保障。实时更新统计信息乃是保障数据库系统稳定高效运转的重要前提之一。OCP 提供未收集统计信息表的统计数据、 Top 10 DML 变更表、 统计信息查询、库/表级别统计信息收集、统计信息收集窗口维护以及统计信息任务管理等功能，涵盖查看、锁定以及停止等能力，有助于用户更出色地进行数据库的管理与维护工作，保障数据库平稳运行。

<main id="notice" type='explain'>
<h4>说明</h4>
<ul>
<li>仅 OceanBase V4.3.3 及以上版本支持统计信息管理。</li>
<li>统计信息管理仅支持业务表（特指用户创建的表，不支持系统表）。</li>
</ul>
</main>

## 修复的问题

OCP V4.3.2 版本主要修复如下问题：

* 修复了并发事务较多时 OAS 事务数据采集不全的问题。
* 修复了 OceanBase 集群单节点故障时无法进行替换的问题。
* 修复了多集群模式下无法立刻进行容灾切换的问题。
* 优化了输入框卡顿的前端问题。

## 已知问题

| 编号 | 已知问题   | 规避方法  |
|-------|---------|---------------|
| 1 | Oracle 备租户无法选择参数模板。| 暂无，建议不要选取特殊参数。 |
| 2 | SQL 采样明细数据不准。| 暂无，可以在 OCP 元数据库中查看准确数据。 |
| 3 | 当 OceanBase 时区与 OCP 时区不一致时，备份时间显示有问题。| 暂无。 |

# 版本使用限制

## 硬件要求

OCP-Server 可以安装在物理机上，也支持安装运行在 Docker 容器中。OCP-Server 支持多节点高可用部署模式。

OCP-Server 节点最低硬件要求如下表所示。

| 硬件 | 要求                 |
|-------|------------------------------------|
| CPU  | <li>X86_64，8 核</li><li>ARM aarch 64 架构，8 核</li> |
| 内存 | 可用内存 16 GiB             |
| 网卡 | 万兆网卡                |

OCP-Agent 自身占用资源很少，对安装节点硬件资源没有特别要求。

## 操作系统要求

安装 OCP 服务端（含 OCP-Agent）的操作系统要求如下表所示。

| 服务器类型    | 操作系统    | 支持版本   |
|-------------|------------|-----------|
| x86_64   | RHEL    | 7.2 及以上版本 |
| x86_64   | CentOS   | 7.2 及以上版本 |
| x86_64   | AliOS   | 7.2 及以上版本 |
| x86_64   | openSUSE  | 12SP3 及以上版本 |
| ARM aarch64 | AliOS   | 7.2 及以上版本 |
| ARM aarch64 | 中标麒麟    | 7.6    |
| ARM aarch64 | 华为 EulerOS | 2.0 SP8  |
| x86_64 | Debian    |  Debian GNU/Linux 11 (bullseye)  |
| x86_64 | Ubuntu | Ubuntu 18.04.6 LTS |

## 客户端要求

一般用户会通过 Web 浏览器来访问 OCP 服务，故对客户端的要求如下所示。

| 浏览器   | 最小版本 |
|---------|------|
| Chrome | 88  |
| Firefox | 78  |
| Safari | 14  |
| Edge  | 88  |

如果您需要通过 iOS 操作系统的设备来访问 OCP，版本要求如下表所示。

| 操作系统 | 最小版本 |
|------|------|
| iOS | 10  |

为了具备最佳的使用体验，推荐使用分辨率大于 1440 x 810 的显示器。
