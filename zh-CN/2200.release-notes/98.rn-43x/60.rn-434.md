# OCP V4.3.4

OCP 4.3.4 已正式发布，主要优化了组织角色权限模型，提升系统的整体安全性。

## 版本信息

* **版本号：** V4.3.4

* **前置版本：** V4.3.3 BP1

* **版本发布日期：** 2025 年 1 月 14 日

* **支持的升级路径：**

  * 目前仅支持从 OCP V3.2.4 及之后版本直接升级到当前版本。

  * 对于 OCP V2.3.x 及之后、V3.2.4 之前的版本，需先升级至 OCP V3.3.4 版本。

  * 对于 OCP V2.3.0 之前版本，需先升级至 OCP V2.3.x 版本，再升级到 OCP V3.3.4 版本。

## 支持的 OceanBase 数据库版本

OCP V4.3.4 版本支持下表所列版本的 OceanBase 数据库。

* OceanBase V4.x
* OceanBase V3.2.x
* OceanBase V3.1.x
* OceanBase V2.2.x
* OceanBase V2.1.x
* OceanBase V1.4.x

## 产品新特性

* **优化组织角色权限模型**

    构建起系统管理员 > 组织管理员 > 用户的三层用户管理体系以及资源 & 菜单双维权限控制体系，支持在不同组织之间开展资源共享的灵活机制，可以实现专有云场景下的租户售卖、不同组织/部门间资源隔离以及同一组织下不同用户间的权限隔离，助力用户更有效地管控系统权限，增强系统的整体安全性。

* **实现单机多实例管理**

    支持单宿主机管控多 Docker 实例（Host 模式），深度挖掘大规格机器的硬件潜能，实现硬件资源的最大化利用（新增系统参数 `ocp.agent.use.specific.http.ip`，用于控制 OCP Agent 是否使用分配给 Docker 的 IP 地址，默认为 `false`）。

* **强化 Binlog 基础服务体系**

    全面支持 Binlog 服务的升级操作，达成 Binlog 基础管控能力的全方位覆盖，确保服务的高效性与稳定性。

    <main id="notice" type='notice'>
    <h4>注意</h4>
    Binlog 服务升级后暂不支持保留原设置参数，请完成升级后重新进行配置。
    </main>

## 产品优化

* **租户管理**：主备租户场景下支持自动识别用户黑屏执行 SWITCHOVER/FAILOVER 命令。
* 解决 Chrome 浏览器在 89/90 等低版本场景下 OCP 页面出现 OOM 问题。
* 优化 OceanBase V4.X 在高版本 Linux 下（如麒麟 v10-sp3）重装或删除软件后 Cgroup 失效问题。

## 关键特性解读

### 优化组织角色权限模型

OCP 构建起系统管理员 > 组织管理员 > 用户的三层用户管理体系以及资源 & 菜单双维权限控制体系。

系统管理员在整个系统范畴内拥有对资源与菜单全部权限；组织管理员则全权掌控其所属组织内部的资源与菜单权限；而用户仅能依据被分配的角色权限执行有限的操作。当下系统在权限管控维度上，主要聚焦于资源（包含 OceanBase 集群、租户、OBProxy 集群、主机、Binlog 服务 5 种关键类型）以及菜单（最低层级设定为二级菜单，例如集群或集群 > 概览等）两个层面。系统管理员或组织管理员能够通过创建包含特定资源及菜单权限组合的角色，并精准赋予给用户，从而使用户获得访问对应资源和菜单的合法资格。倘若某个角色仅片面具备资源权限或者菜单权限，那么拥有该角色的用户在实际操作中将无法正常使用系统功能。例如，若某个角色虽被赋予特定集群的资源权限，然而却缺失集群的菜单权限，那么拥有此角色的用户将在系统界面中无法查看到集群页面；同理，若用户仅仅拥有集群的菜单权限而缺乏实际的集群权限，其同样无法操作集群。此外，系统还支持不同组织之间开展资源共享的灵活机制，被共享资源的组织管理员能够将这些共享资源授予本组织内的相应角色和用户。

借助对权限模型的深度优化，OCP 得以有力支撑如下一系列关键业务场景：

* 租户售卖业务场景，通过精细的权限设置确保售卖流程的合规性与安全性。
* 多组织权限隔离业务场景，保障各组织在资源使用与管理上的独立性与自主性，有效避免权限交叉干扰。
* 对 DBA、研发人员以及审计人员进行权限管控及业务场景隔离，清晰界定不同角色群体的权限边界，为数据库运维、开发以及审计工作提供严谨且高效的权限管理保障。

**模型示意图**

![1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/434/01161403.png)

**使用说明**

* OceanBase 集群、租户以及对应的主机具有权限向下包含关系。
* 具有某个租户权限的用户默认具有集群的只读权限。

**功能限制**

* 请勿将任务中心、告警中心、参数模板、标签等功能授予组织管理员、普通用户。
* 用户名、角色名、集群名称、标签名称、监控大盘名称、告警模板名称，预案名称等名称类请保持整个系统内的唯一性。
* 此版本对权限模型进行了重构，对于历史自定义权限的角色无法自动兼容，需要您参考 [用户管理](../../1600.system-management-features/200.manage-users/50.user-management-overview.md) 重新配置自定义角色的权限。

## 修复的问题

OCP V4.3.4 版本主要修复如下问题：

* 修复了并发事务较多时 OAS 事务数据采集不全的问题。
* 修复了 Oracle 备租户无法选择参数模板的问题。
* 优化了主机标准化流程，支持更多自动修复场景。

## 已知问题

| 编号 | 已知问题   | 规避方法  |
|-------|---------|---------------|
| 1 | 角色权限更新后不会立即生效，需要退出后重新登录。| 暂无，一般权限管理都需要重新登录。 |
| 2 | 使用 SSO、BUC 等第三方登录方式时，自动授权后不支持修改用户的组织信息。| 暂无。 |

# 版本使用限制

## 硬件要求

OCP-Server 可以安装在物理机上，也支持安装运行在 Docker 容器中。OCP-Server 支持多节点高可用部署模式。

OCP-Server 节点最低硬件要求如下表所示。

| 硬件 | 要求                 |
|-------|------------------------------------|
| CPU  | <li>X86_64，8 核</li><li>ARM aarch 64 架构，8 核</li> |
| 内存 | 可用内存 16 GiB             |
| 网卡 | 万兆网卡                |

OCP-Agent 自身占用资源很少，对安装节点硬件资源没有特别要求。

## 操作系统要求

安装 OCP 服务端（含 OCP-Agent）的操作系统要求如下表所示。

| 服务器类型    | 操作系统    | 支持版本   |
|-------------|------------|-----------|
| x86_64   | RHEL    | 7.2 及以上版本 |
| x86_64   | CentOS   | 7.2 及以上版本 |
| x86_64   | AliOS   | 7.2 及以上版本 |
| x86_64   | openSUSE  | 12SP3 及以上版本 |
| ARM aarch64 | AliOS   | 7.2 及以上版本 |
| ARM aarch64 | 中标麒麟    | 7.6    |
| ARM aarch64 | 华为 EulerOS | 2.0 SP8  |
| x86_64 | Debian    |  Debian GNU/Linux 11 (bullseye)  |
| x86_64 | Ubuntu | Ubuntu 18.04.6 LTS |

## 客户端要求

一般用户会通过 Web 浏览器来访问 OCP 服务，故对客户端的要求如下所示。

| 浏览器   | 最小版本 |
|---------|------|
| Chrome | 88  |
| Firefox | 78  |
| Safari | 14  |
| Edge  | 88  |

如果您需要通过 iOS 操作系统的设备来访问 OCP，版本要求如下表所示。

| 操作系统 | 最小版本 |
|------|------|
| iOS | 10  |

为了具备最佳的使用体验，推荐使用分辨率大于 1440 x 810 的显示器。
