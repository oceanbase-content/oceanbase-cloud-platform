# OCP V3.3.4

#RNDate#2022-10-21

OceanBase 云平台（OceanBase Cloud Platform，OCP）新版本主要新增了部分审计事件，同时针对其它功能进行了提升优化。

## 版本信息

* **版本号：** V3.3.4

* **前置版本：** V3.3.3

* **版本发布日期：** 2022 年 10 月 21 日

* **支持的升级路径：** 对于 OCP V2.3.x 及之后版本，均可以直接升级到本版本。对于 OCP V2.3.0 之前版本，需要首先升级到 V2.3.x 版本，然后再升级到本版本。

## 支持的 OceanBase 数据库版本

OCP V3.3.4 版本支持下表所列版本的 OceanBase 数据库。

* OceanBase V1.4.x

* OceanBase V2.1.x

* OceanBase V2.2.x

* OceanBase V3.1.x

* OceanBase V3.2.x

## 功能优化

* 操作审计：新增审计事件，包括停止 Zone、启动 Zone、重启 Zone、修改死锁检测开关、删除软件包、修改 OceanBase 集群 TopSQL 开关、触发 OceanBase 集群合并、清除 OceanBase 集群合并失败状态、租户 Unit 运维（扩容缩容）。

* 诊断中 **可疑 SQL** 增加新判断模式，PARTITION_CNT 大于 AffectRows 时列为 **可疑 SQL**。

* 优化备集群创建流程，主备集群创建成功标志由原 **add standy 命令成功** 调整为 **快照接入完成**。

* 优化测试告警功能，增加环境变量默认值，提升测试告警成功率。

* 优化二次备份路径预检查逻辑，禁止备份路径下存在相同集群名的目录。

## 修复的问题

OCP V3.3.4 版本修复了以下问题：

1. 修复系统变量 `connect_timeout` 单位 **秒** 误写为 **微秒** 的问题。

2. 修复流控关闭时 OCP 无法启动的问题。

3. 修复某个告警消息主机 IP 描述错误的问题，及租户列表描述错误的问题。

4. 修复某些无法修改的参数在前端显示为可以修改的问题。

5. 优化 AWR 报告生成性能，减少租户数量多（100 +）的情况下生成报告超时的频率。

6. 优化内部表查询语句，避免因业务压力导致集群状态显示异常。

7. 优化主机运维操作的容错性。

8. 优化 Grafana 监控推送逻辑，避免出现无数据的情况。

9. 优化主机 NTP 时延采集方式，提升在主机负载状态下的准确性。

## 已知问题

| 编号 | 已知问题      | 规避方法   |
|----|---------|---------------|
| 1  | 二次备份数据后，恢复租户时解析出的源租户信息不符合预期。 | 暂无。 |
| 2  | 集群性能监控中，事务日志数为 0。      | 暂无。   |

## 版本使用限制

### 硬件要求

OCP-Server 可以安装在物理机上，也支持安装运行在 Docker 容器中。OCP-Server 支持多节点高可用部署模式。

OCP-Server 节点最低硬件要求如下表所示。

| 硬件  | 要求                                 |
|-----|------------------------------------|
| CPU | <li>X86_64，8 核</li><li>ARM aarch 64 架构，8 核</li> |
| 内存  | 可用内存 16 GB                         |
| 网卡  | 万兆网卡                               |

OCP-Agent 自身占用资源很少，对安装节点硬件资源没有特别要求。

### 操作系统要求

安装 OCP 服务端（含 OCP-Agent）的操作系统要求如下表所示。

|    服务器类型    |    操作系统    |   支持版本    |
|-------------|------------|-----------|
| x86_64      | RHEL       | 7.2 及以上版本 |
| x86_64      | CentOS     | 7.2 及以上版本 |
| x86_64      | AliOS      | 7.2 及以上版本 |
| x86_64      | openSUSE   | 12SP3 及以上 |
| ARM aarch64 | AliOS      | 7.2 及以上版本 |
| ARM aarch64 | 中标麒麟       | 7.6       |
| ARM aarch64 | 华为 EulerOS | 2.0 SP8   |

### 客户端要求

一般用户会通过 Web 浏览器来访问 OCP 服务，故对客户端的要求如下所示。

| 浏览器     | 最小版本 |
|---------|------|
| Chrome  | 81   |
| Firefox | 64   |
| Safari  | 10   |
| Edge    | 13   |

如果您需要通过 iOS 操作系统的设备来访问 OCP，版本要求如下表所示。

| 操作系统 | 最小版本 |
|------|------|
| iOS  | 10   |

为了具备最佳的使用体验，推荐使用分辨率大于 1440 x 810 的显示器。
