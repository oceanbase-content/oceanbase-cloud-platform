# OCP V3.3.3

#RNDate#2022-07-18

OceanBase 云平台（OceanBase Cloud Platform，OCP）新版本主要针对密码箱及巡检功能进行升级，并对 OceanBase 版本进行适配，同时对其它功能进行了提升优化。

## 版本信息

* **版本号：** V3.3.3

* **前置版本：** V3.3.1

* **版本发布日期：** 2022年 7 月 18 日

* **支持的升级路径：** 对于 OCP V2.3.x 及之后版本，均可以直接升级到本版本。对于 OCP V2.3.0 之前版本，需要首先升级到 V2.3.x 版本，然后再升级到本版本。

## 支持的 OceanBase 数据库版本

OCP V3.3.2 版本支持下表所列版本的 OceanBase 数据库。

* OceanBase V1.4.x

* OceanBase V2.1.x

* OceanBase V2.2.x

* OceanBase V3.1.x

* OceanBase V3.2.x

## 新增功能

### 密码箱

* 支持对于接管的集群进行集群或租户的密码的导入、导出、及分享操作。

* 支持将密码箱中的连接凭证分享给其他 OCP 的用户。

### 监控

租户性能监控页面新增 **内存使用率** 指标，支持展示 OceanBase 端租户的已使用内存百分比。

### 安全

* 新增 **设置密码激活账号** 功能，初次登录 OCP 时需修改内置账号密码。
  
* 浏览器控制台中去掉关于明文密码的提示信息，提升系统安全性。

## 功能增强

### OBProxy

支持 OBProxy 集群修改重启生效的参数。

### 巡检

将 **集群健康巡检** 功能统一到 **巡检** 模块，完善并优化巡检功能。

### 版本适配

* 适配 OceanBase V3.2.4 版本，支持创建 MySQL 租户时导入 SRS 数据。

* 适配 OceanBase V3.2.3.1 版本，对内核版本号获取方式适配新规则。

## 修复的问题

OCP V3.3.2 版本修复了以下问题：

* 优化若干 Agent 的性能问题，提高 Agent 稳定性。

* 优化 Server 端线程池逻辑，提高监控查询性能。

* 优化备份恢复采集流程，提高 OCP 在大容量备份下的稳定性。

* 优化 SQL 诊断数据的实时性，提升 OAS 获取诊断数据速度。

* 优化 admin 账号组织权限验证逻辑，以适应专有云场景。

* 优化创建集群时默认目录的预检查流程，支持在有问题的状况下提前暴露错误，避免回滚整个任务。

* 修复 monagent 文件句柄残留的问题。

* 修复特殊场景下报错集群连接失败的问题。

* 修复备份恢复调度超时的问题。

* 修复备份恢复从低版本（V2.x）升级到高版本（3.x）后无法查看服务列表的问题。

* 修复备份恢复按状态筛选失败的问题。

* 修复无数据时合并管理页面报 NPE 的问题。

* 修复使用 OAT 部署 OCP V3.3.0 失败的问题。

* 修复一些巡检国际化的问题。

* 修复特定情况下数据盘使用率显示超过 100% 的问题。

* 修复异常情况下对 CPU sys 使用率无告警的问题。

## 已知问题

| 编号 |                   已知问题                   |     规避方法      |
|----|------------------------------------------|---------------|
| 1  | V3.1.x 升级到 V3.3.3 后特定情况下会导致 QPS 历史数据查询不到 | 暂时不影响业务，可不规避。 |
| 2  | 非常规场景下多集群模式创建备集群报 NPE                    | 暂时不影响业务，可不规避。 |
| 3  | 部分接口在白屏访问时会连续请求两次                        | 暂时不影响业务，可不规避。 |
| 4  | 巡检报告语言切换后不会及时生效，需要手动刷新                   | 暂时不影响业务，可不规避。 |
| 5  | SQL 诊断中根据 OBServer 节点地址筛选 SQL ，筛选结果显示不准确   | 暂时不影响业务，可不规避。 |

## 版本使用限制

### 硬件要求

OCP-Server 可以安装在物理机上，也支持安装运行在 Docker 容器中。OCP-Server 支持多节点高可用部署模式。

OCP-Server 节点最低硬件要求如下表所示。

| 硬件  |                 要求                 |
|-----|------------------------------------|
| CPU | <li>X86_64，8 核</li><li>ARM aarch 64 架构，8 核</li> |
| 内存  | 可用内存 16 GB                         |
| 网卡  | 万兆网卡                               |

OCP-Agent 自身占用资源很少，对安装节点硬件资源没有特别要求。

### 操作系统要求

安装 OCP 服务端（含 OCP-Agent）的操作系统要求如下表所示。

|    服务器类型    |    操作系统    |   支持版本    |
|-------------|------------|-----------|
| x86_64      | RHEL       | 7.2 及以上版本 |
| x86_64      | CentOS     | 7.2 及以上版本 |
| x86_64      | AliOS      | 7.2 及以上版本 |
| x86_64      | openSUSE   | 12SP3 及以上 |
| ARM aarch64 | AliOS      | 7.2 及以上版本 |
| ARM aarch64 | 中标麒麟       | 7.6       |
| ARM aarch64 | 华为 EulerOS | 2.0 SP8   |

### 客户端要求

一般用户会通过 Web 浏览器来访问 OCP 服务，故对客户端的要求如下所示。

|   浏览器   | 最小版本 |
|---------|------|
| Chrome  | 81   |
| Firefox | 64   |
| Safari  | 10   |
| Edge    | 13   |

如果您需要通过 iOS 操作系统的设备来访问 OCP，版本要求如下表所示。

| 操作系统 | 最小版本 |
|------|------|
| iOS  | 10   |

为了具备最佳的使用体验，推荐使用分辨率大于 1440 x 810 的显示器。
