# 部署常见问题

本页面为您介绍在部署 OCP 时遇到的常见问题的解决方法。

**Q1: OAT 执行初始化本机任务后无法访问，应如何处理？**

A：原因： OAT 容器启动时使用了默认的 `docker bridge` 网络模式，此模式要求系统内核参数 `net.ipv4.ip_forward` 必须为 `1`。对 OAT 所在的服务器执行初始化时，如果您选择的用途为 `observer`， OAT 会把此项参数设置为 `0`，这将导致无法访问 OAT 服务。 
方案： 更改系统内核参数，`sysctl -w net.ipv4.ip_forward=1` 临时打开转发。建议您使用 `docker host` 网络模式启动 OAT，以避免此类问题。OAT 默认监听端口为 `7000` 和 `3306`，如果您使用 `docker host` 网络启动，您必须确保服务器上无冲突服务。

**Q2: OAT 日志文件位置？**

A: 启动 OAT 时，需要挂载一个 `data` 目录作为 OAT 所有的持久化数据的存储位置。您可以通过 `docker inspect <oat容器名> -f '{{.Mounts}}'` 命令来查看实际位置。OAT 日志文件在此目录的 `logs` 子目录下，其中 `server.std` 对应 WEB 服务的日志，`scheduler.std` 对应内部任务调度器的日志。。

**Q3: 负载均衡如何配置？**

A: 当 OCP 为多节点部署时，一般要求使用两个负载均衡地址：

   1. HTTP 协议的 7 层代理，后端为产品在多台服务器上的 WEB 服务端口，要求负载开启会话保持功能，用于用户自身直接使用浏览器访问或一些进程使用产品提供的服务接口。
   2. TCP 协议的 4 层代理，后端为产品使用的 MetaDB 在多台服务器上的服务端口（默认 `2883`），如果用户使用 OAT 支持的 NLB 或 OBDNS 作为负载均衡，4 层代理无需用户填写，在产品部署过程中会自动完成相应配置。
