# 管理任务

通过 OCP 界面发起的运维和管理 OceanBase 集群、租户以及主机的任务和管理 OCP 系统的任务，OCP 提供对这些任务的管理和查看。

本节介绍如何查看任务详情、如何处理失败的任务。

## 前提条件

登录用户拥有系统管理员（ADMIN）或任务管理（TASK_MANAGER）角色。

## 查看任务详情

1. 登录 OCP。

2. 单击页面上方 **任务中心**。

3. 在 **任务列表** 页面，您可通过任务执行状态和发起者对任务进行筛选，或通过操作对象和任务名称对任务进行搜索。

   ![07021600](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/420/%E4%BB%BB%E5%8A%A1%E5%88%97%E8%A1%A8.png)

   **任务列表** 中将返回所有符合条件的任务。其中，支持单击 **操作对象** 中的链接跳转至 **对象** 的概览页面。

   <main id="notice" type='explain'>
   <h4>说明</h4>
   <p>若任务的操作对象已被删除，则只支持查看对象名称及对象类型，不支持跳转至 <b>对象</b> 概览页面。</p>
   </main>

4. 单击要查看的任务名，进入该任务的详细界面。

   任务详情页中默认以日志视图展示，可通过如图中 ① 处的按钮切换成流转视图。

   日志视图下，提供对进展的多个任务日志的展示，可通过图中左侧区域进行子任务切换。如下图所示，当 `Do io bench` 步骤失败后，有下载日志、重新运行或设置为成功的操作，单击对应按钮则可执行相应的操作。

   ![07021544](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/420/%E4%BB%BB%E5%8A%A1%E8%AF%A6%E6%83%85.png)

5. 任务详情页中，以流转视图为例，单击指定子任务右侧的 **...** 中的操作项即可操作当前子任务。子任务的状态不同所支持的操作也不同，具体以 **...** 中显示的为准。日志视图下也支持此操作。

   <main id="notice" type='explain'>
   <h4>说明</h4>
   <p>任务详情页中 <strong>流转视图</strong> 通过拓扑图展示各个步骤的上下游关系。通过鼠标在空白处拖拽可以移动拓扑图，通过鼠标滚轮滑动可以进行缩放，也可以通过右上方的缩放控件调整画布大小。拓扑图缩放是以鼠标指针为中心进行的，对于任务流程比较长的情况，可以先缩小，快速定位到关心的步骤，再进行放大，达到快速定位的目的。</p>
   </main>

   * 成功状态的子任务可执行查询日志操作。

     展开折叠菜单后，在屏幕的下方会出现折叠窗口展示日志信息，窗口可以拖动进行放大。

   * 失败状态的子任务可执行如下操作。

     * 查看日志信息。

     * 重新运行：重新运行当前子任务，即先回滚再执行，成功执行的话继续执行下游子任务。

     * 设置为成功：将当前子任务的状态直接设置为成功状态，继续执行下游子任务。

   * 运行状态的子任务可查看日志或者终止运行，终止运行后该子任务会变为失败状态。

   * 等待运行的子任务可进行查看日志操作。

   ![1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/420/%E4%BB%BB%E5%8A%A1%E8%AF%A6%E6%83%85%E6%B5%81%E8%BD%AC%E5%9B%BE.png)

## 重试/放弃失败任务

1. 登录 OCP。

2. 单击页面上方 **任务中心**，进入 **任务列表** 页面。

3. 单击要查看的任务名，进入该任务的详细页面。

4. 在任务详情页面的右上角单击 **放弃任务** 或 **重试** 。

   ![05101010](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/420/%E5%A4%B1%E8%B4%A5%E4%BB%BB%E5%8A%A1.png)

   * 放弃任务：从失败处向任务的根结点，执行每一个步骤的回滚操作，主要用于任务的资源回收、状态修改等目的。

   * 重试：回滚当前步骤所有失败节点并再次执行，如果执行成功则继续执行后续步骤。
