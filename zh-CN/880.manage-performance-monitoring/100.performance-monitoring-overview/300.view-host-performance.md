查看主机性能
=========================

OCP 支持从不同维度查看主机的各种性能监控数据，您可以从以下三个入口进行查看：

* **入口一：**

  1. 登录 OCP 。

  2. 在左侧导航栏单击 **集群**，进入 **集群** 页面。

  3. 在 **集群列表** 区域，选择待操作的集群并单击其集群名。

  4. 在显示的页面的左侧导航栏上，单击 **性能监控** 。

  5. 在 **集群性能** 页签中查看主机性能监控数据。

* **入口二：**

  1. 登录 OCP 。

  2. 选择 **主机** 。

  3. 在 **主机列表** 区域，选择待操作的主机并单击该主机 IP 地址。

  4. 在显示的页面上，单击 **监控** 页签。

  5. 在 **主机性能** 页签中查看主机性能监控数据。

* **入口三：**

  1. 登录 OCP。

  2. 在左侧导航栏选择 **性能监控**。

  3. 系统默认进入 **OceanBase 集群** 的监控页面。

  4. 单击 **主机性能** 页签，查看主机性能监控数据。

前提条件
-------------------------

* 当前登录的 OCP 用户有待查看集群的 **只读** 权限。
* 只有通过 **集群 > 性能监控** 和 **性能监控** 入口查看主机性能监控时才支持下钻功能，**主机 > 监控** 入口的性能监控不具有下钻功能。

操作步骤
-------------------------

以下操作步骤以 **入口三** 为例。

1. 登录 OCP 。

2. 在左侧导航栏选择 **性能监控** 。

3. 系统默认进入 **OceanBase 集群** 页签。

4. 在 **数据筛选** 区域，配置监控数据筛选条件。

   筛选条件说明如下表所示：

   |     筛选条件  |  描述  |
   |---------------|---------|
   | 集群 | 自动刷新模式下不展示。选择某一个集群，对该集群进行监控。  |
   |Zone |默认对所有 Zone 进行监控。|
   |OBServer|默认对所有 OBServer 节点进行监控。|
   | 选择时间（又称：监控窗口） | 自动刷新模式下不展示。 选择某一段时间范围，用于返回这段时间范围内的数据。  |
   |自动刷新  |默认关闭，打开后，每 5s 进行一次刷新。|
  
   ![1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/410/%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E6%8D%AE%E7%AD%9B%E9%80%89.png)

5. 单击 **主机性能** 页签，查看主机性能监控数据。当统计范围包含多台 OBServer 节点时，则展示多台 OBServer 节点的聚合值。

   此处所有监控项的具体含义及取值来源，您都可参考 [监控指标概述](../../1900.reference-guide/300.monitoring-indicator-reference/100.overview-of-metrics.md) 理解。下述功能能够帮您更好的在趋势图中查看和分析性能监控数据，您可结合图片及下述文字理解。

   ![1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/410/%E4%B8%BB%E6%9C%BA%E6%80%A7%E8%83%BD.png)

   1. 隐藏其他细分指标的数据：单击其他细分指标标识，使其置灰，趋势图中将不展示该指标信息。

   2. 将光标悬停于趋势图中某时刻，可查看某时刻详细数据；拖拽光标选中某区域，系统会放大显示该区域的趋势信息，您可查看改一指标的在此时间段的详细趋势，双击该趋势图可恢复。

   3. 放大某一趋势图：单击趋势图右上角的放大图标。上图中的 ①、②、④ 功能在放大的趋势图中同样适用。

   4. 下钻查看不同维度的监控数据：当您发现租户的监控数据异常时，如租户响应时间过高，您可通过下钻分析，定位到引起响应时间异常的服务器。单击趋势图右上角的 **下钻分析** 图标，**主机性能** 支持的下钻维度为：**集群 \> 主机**。

      上图中 ①、② 的功能在下钻页面的趋势图中同样适用，此外您还可以：

      ![1202](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/410/%E4%B8%BB%E6%9C%BA%E4%B8%8B%E9%92%BB.png)

      1. 在下钻页面的 **数据筛选** 区域重新设置筛选条件，如您未设置则会自动继承上层设置，如上图所示 ①。

      2. 如该指标存在细分指标，您可以选择细分指标进行查看，如上图所示 ②；或单击如图所示的 ③ 处下钻到不同维度进一步分析。

      3. 如该指标涉及主机性能，您可将光标悬停于如图示 ③ 的 **前往主机性能监控** 链接上，选择相应主机并单击，即可跳转到主机 **监控** 页面。

      4. 您也可通过趋势图右侧如图示 ④ 的按钮，选择需要在趋势图中展示的主机。

      ![集群监控下钻_new](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/421/%E5%9B%BE%E7%89%87.gif)

6. （可选）配置监控采集间隔。

   当前 OCP 秒级别监控采集默认 1s 采集一次，该采集规模对 OCP Server 性能及 MonitorDB 的存储性能要求较高。在对监控数据要求不高的情况下，您可通过修改 config_properties 中 ocp.metric.collect.interval.second 的 value 值来配置监控采集间隔，从而减少资源占用、增加整体管理规模。

    <main id="notice" type='explain'>
    <h4>说明</h4>
    <p>目前只支持配置的 value 值为 1、5、10 和 15。若您填写了其他不在上述列举内的数值，系统会自动进行适配：</p>
    <ul>
    <li>小于 1 统一为 1。</li>
    <li>[1,5) 区间向下兼容为 1。</li>
    <li>[5,10) 区间向下兼容为 5。</li>
    <li>[10,15) 区间向下兼容为 10。</li>
    <li>其余统一为 15。</li>
    </ul>
    </main>

   配置修改后 OCP 会立即以新的采集间隔进行采集，监控数据的展示间隔会默认为采集间隔的 3 倍（采集间隔 1s 除外）。如采集间隔为 5s，查询时秒级查询的监控数据的展示间隔则为 15s。
