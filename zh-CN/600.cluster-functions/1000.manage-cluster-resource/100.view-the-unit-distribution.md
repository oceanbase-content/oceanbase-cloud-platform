# 查看 Unit 分布

您可通过 Unit 分布来查看每个租户在 OceanBase 集群中的物理分布和资源占用情况。

Unit 分布为您提供了 **Unit 视图** 和 **副本视图** 信息的查看。

在左侧导航栏单击 **集群** ，在 **集群列表** 中单击集群名称，进入对应的集群页面。单击左侧导航栏的 **资源管理** ，系统默认进入 **Unit 分布** 页面。

  <main id="notice" type='explain'>
    <h4>说明</h4>
    <p>当集群为 V4.0 及以上版本时，不展示 <strong>副本视图</strong> 信息。</p>
  </main>

## Unit 视图

系统默认进入 **Unit 视图** 页签，以 Unit 视图维度展示 Unit 的分布情况，其中每一列为一个 OBServer。

* 单击 **租户** ，可选择想要查看的租户。

* 单击 **区域** ，可选择当前集群所在的物理区域。

* 单击 **Zone** ，可选择 Zone1、Zone2 或 Zone3 进行查看。

* 单击 **机型** ，可选择集群中不同主机机型。

* 开启资源单元（Unit）负载均衡：

  * 当 OceanBase 集群为 V4.x 时，打开 **自动迁移** 开关，当系统资源消耗不均衡时，将自动进行后台迁移操作，实现资源单元（Unit）的自动负载均衡。当机器下线或处于 DELETING 状态时，Unit 迁移不受该配置项控制。

  * 当 OceanBase 集群为 V2.x 或 V3.x 时，打开 **启用迁移** 开关，当系统资源消耗不均衡时，支持进行后台自动以及手动迁移操作。当机器下线或 DELETING 状态时，Unit 迁移不受该配置控制。

* 打开 **自动刷新** 开关，Unit 视图将每 1s 刷新一次，您可通过该功能查看 Unit 分布的最新情况。

  * 查看集群负载是否均衡：

    查看每个 Zone 下分配的 **已分配内存** 、 **已分配 CPU** 、 **已使用数据盘** 三个属性值，用来判断同一类型资源在 Zone 内机器上的使用率是否基本一致，如果基本一致则表明负载均衡；否则可以通过调整 OceanBase 集群的负载均衡相关参数来控制 OceanBase 集群重新进行均衡。

  * 判断集群是否需要扩容：

    可根据 **已使用数据盘** 百分比来判断集群的数据盘容量是否够用，当数据盘使用量到达数据盘容量 80% 时，则可以考虑增加机器进行扩容，使数据盘水位保持在正常水位。

  * 查看单个租户的资源分布情况：

    单击视图上方的 **租户**，在下拉框中选择要查看的租户名，单击 **确认** 即可看到该租户的分布情况。

  * 查看租户详情概览：

    * 将光标悬停于租户名上，可查看当前租户信息，包括：租户名、租户 ID、租户状态、Zone 优先级排序、副本分布情况及仲裁服务状态。
    * 租户后的 Unit 卡片中展示了租户的资源规格及副本信息。将光标悬停与该卡片上，可查看当前租户的详细 OBServer 信息，包括 Unit ID，租户名、资源池、CPU（核）、内存（GB）、已使用数据盘（GB）等。

        <main id="notice" type='explain'>
        <h4>说明</h4>
        <p>当集群为 V4.0 及以上版本时，Unit 卡片中新增如下 OBServer 信息：<ul><li>新增日志盘（GB）、IOPS 及已使用日志盘（GB）数据。</li><li>新增 <b>Leader</b> 标签，该标签表示当前 OBServer 存在 leader 日志流。</li><li>新增是否存在主副本及副本类型标签相关信息，副本类型包括 FULL（全功能型副本）和 READONLY（只读型副本）。</li></ul></p>
        </main>

    单击视图中的租户名称，页面跳转至租户的 **概览** 页面。您可在该页面查看租户详细信息，包括副本详情、Zone 优先级及白名单信息等。

  * 如何进行手动负载迁移：

    当 OceanBase 集群自带的负载均衡算法无法满足用户需求的时候，可以通过单击租户后的 UNIT 卡片进行资源的迁移操作，迁移只能在单个 Zone 内进行。

    <main id="notice" type='explain'>
    <h4>说明</h4>
    <p>手动进行负载均衡时，建议关闭 OceanBase 集群的自动负载功能。OceanBase 集群的负载均衡可能会影响当前用户设定，将 Unit 迁回原来的位置。</p>
    </main>

  * 查看 Unit 数量：
  
      可在 **Unit 数目** 查看当前环境中的 Unit 数量，当 Unit 数目大于租户数量时，则表示存在没有关联租户的 Unit ，您可将空闲时间超过 1 小时的 Unit 进行删除或合并。

![Image 105](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/420/Unit%E5%88%86%E5%B8%83.png)

## 副本视图

单击 **副本视图** 页签，即可在页面中以副本视图维度查看副本的分布情况，其中每一列为一个 OBServer。

* 单击 **租户** ，可选择想要查看的租户。

* 单击 **区域** ，可选择当前集群所在的物理区域。

* 单击 **Zone** ，可选择 Zone1、Zone2 或 Zone3 进行查看。

* 单击 **机型** ，可选择集群中不同主机机型。

* 打开 **自动刷新** 开关，副本视图将每 30s 刷新一次，您可通过该功能查看副本分布的最新情况。

  * 查看集群负载是否均衡：

    查看每个 Zone 下的 **已分配内存** 、 **已分配 CPU** 、 **已使用磁盘** 三个属性值，用来判断同一类型资源在 Zone 内主机上的使用率是否基本一致，如果基本一致则表明负载均衡；否则可以通过调整 OceanBase 集群的负载均衡相关参数来控制 OceanBase 集群重新进行均衡。

    如下图中的 ③ 和 ④，③ 为当前 OBServer 的已分配内存，④ 为当前 OBServer 的总内存。

  * 判断集群是否需要扩容：

    可根据 **已使用磁盘** 百分比来判断集群的磁盘容量是否够用，当磁盘使用到量到达磁盘容量 80% 时，则可以考虑增加机器进行扩容，使磁盘水位保持在正常水位。

  * 查看单个租户的资源分布情况：

    在 **租户** 下拉框中选择要查看的租户名，单击 **确认** 即可看到该租户的分布情况。

    将光标悬停至租户后的副本卡片，可查看该租户的主副本数和副本总数。

    如下图中的 ① 和 ②，① 为租户在 OBServer 的主副本数，② 为租户在 OBServer 的副本总数。

  * 查看租户详情概览：

    单击视图中的租户名称，页面跳转至租户的 **总览** 页面。您可在该页面查看租户详细信息，包括副本详情、Zone 优先级及白名单信息等。

  * 启动或停止 OBServer：

    单击主机地址后的主机卡片，您可进行 OBServer 的启动或停止操作。

   <main id="notice" type='notice'>
    <h4>注意</h4>
    <p>停止 OBServer 服务会将所有流量和主副本的角色切到其他 OBServer，请谨慎操作。</p>
   </main>

  ![Image 184](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/7548099461/p429893.png)
