# 集群管理

OceanBase 数据库集群由一个或多个 Region 组成，Region 由一个或多个 Zone 组成，Zone 由一台或多台服务器组成。Region 对应物理上的一个城市或地域，当 OceanBase 数据库集群由多个 Region 组成时，数据库的数据和服务能力就拥有地域级容灾能力，当集群只有一个 Region 时，如果出现整个城市级别的故障，则会影响数据库的数据和服务能力。Zone 对应一个有独立网络和供电容灾能力的数据中心，在一个 Region 内的多个 Zone 间 OceanBase 数据库集群拥有 Zone 故障时的容灾能力。通常情况下，OceanBase 数据库集群的一个 Zone 内只会有数据的一份拷贝，如果整个集群只有一个 Zone，则集群没有容灾能力。如果实际的运行环境只有一个数据中心的若干台机器，则可以将若干台机器划分成虚拟的 Zone，OceanBase 数据库会在这些虚拟的 Zone 之间具备容灾能力。

OceanBase 数据库创新的容灾能力有三地五中心可以无损容忍城市级灾难，以及同城三中心可以无损容忍数据中心级故障。OceanBase 数据库通过将数据在多个 Region 或者多个 Zone 内保留数据拷贝，并使用 Paxos 一致性协议保证副本之间的强一致，在城市级灾难或者数据中心故障时既保证数据的可靠性，又能保证数据库服务的可用性，达到可靠性与可用性的平衡。

**多 Region 集群：**

![集群管理.jpg](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/5193025261/p184497.jpg "集群管理.jpg")

**多 Zone 集群：**

![集群管理2.jpg](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6193025261/p184498.jpg "集群管理2.jpg")

OceanBase 数据库的无损容灾能力还可以方便集群的运维操作，当数据中心或者服务器需要替换和维修时，可以直接下线对应的数据中心或服务器进行替换和维修，并补充进新的数据中心或服务器，OceanBase 数据库系统会自动进行数据的复制和均衡，整个过程可以保证数据库服务的使用不受影响。

OceanBase 数据库集群的每台服务器上会运行 observer 进程，observer 进程负责整个数据库服务的各项功能，包括资源管理与租户创建，数据分布的管理，数据副本之间的 Paxos 协议，单机或分布式的数据查询与修改等。OCP 支持 observer 进程随 ocp_agent 开机自启动功能，当机器重启后，会自动拉起 observer 并恢复至机器重启前的状态，详情可参见 [OCP Agent 进程](../850.host-features/800.ocp-agent-process.md)。

## 集群总览

登录 OCP 云平台后，单击左侧导航栏的 **集群** 进入 **集群** 页面。当前登录用户需要具备集群的管理权限或只读权限，才能查看集群概览数据。

**集群概览** 页面展示了当前登录用户下的集群概览信息，包括：**性能指标 Top5**、**集群合并时间 Top5** 和 **集群列表**。

同时也可以进行 [接管集群](300.manage-a-cluster/400.take-over-a-cluster.md) 和创建集群的操作。其中，创建集群包括 **创建单机集中式数据库** 和 **创建分布式集群** 两种方式。

* **创建单机集中式数据库**

  单机集中式为 OceanBase 数据库的单机形态，仅支持单个主机、单个 Zone 和单个 OBServer 节点，无多副本数据保护。相较于分布式集群，单机集中式具有小型化、轻量化的特点，适用于开发测试以及数据安全要求不高的业务系统，能够帮助您更简洁、快速地使用 OceanBase 数据库。详情参见 [创建单机集中式数据库](200.create-a-cluster/200.create-a-standalone-centralized-cluster.md)。

  <main id="notice" type='explain'>
  <h4>说明</h4>
  <p>仅 OceanBase V4.1.0 及以上版本支持单机集中式。</p>
  </main>

* **创建分布式集群**

  分布式集群为 OceanBase 数据库的分布式形态，支持多主机、多 Zone 和多 OBServer 节点，且支持多副本数据保护。相较于单机集中式，分布式集群具备金融级高可用以及平滑扩缩容能力，能高度兼容 Oracle/MySQL 模式，适用于对数据安全要求较高的核心业务系统。详情参见 [创建分布式集群](200.create-a-cluster/100.create-a-distributed-cluster.md)。

### 集群列表

集群列表区域展示了各集群的 **集群名**、**状态**、**操作**、**已分配 CPU**、**已分配内存**、**已使用数据盘**、**租户数**、**OceanBase 版本号**、 **部署模式**、 **CPU 架构**、 **创建时间** 和 **告警信息** 等。其中，支持对集群名进行批量查询，各集群名之间使用空格间隔。

* 单击各集群的集群名称，可以跳转到集群详情页面，详情参见 [集群详情页概述](300.manage-a-cluster/200.overview-of-the-cluster-details-page.md)。
* 当集群处于 **运维中** 状态时，单击 **操作列** 的 **查看任务** 按钮，可以跳转至集群运维的任务详情页面。在任务详情页面，您可进行查看任务日志、回滚和重试等操作，详情参见 [管理任务](../1600.system-management-features/100.manage-tasks.md)。
* 将光标悬停于集群标签上，可查看该集群的所有标签信息。支持单击编辑图标对标签进行管理，操作详情可参见 [管理标签](../1600.system-management-features/800.manage-tags/100.tags-overview.md)。

![1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/421/%E9%9B%86%E7%BE%A4%E5%88%97%E8%A1%A8.png)

### 性能指标 Top5

**性能指标 Top5** 区域展示了某个时间段内某个性能指标的和从大到小排序最大的 5 个集群。您可以根据业务需要，选择待查看的性能指标和对应的时间范围。单击右上角图标，可对图标进行放大查看。

![1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/410/%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87top5.png)

* 可选择的性能指标包括： **QPS（time/s）、查询响应时间（us）、活跃会话数** 和 **CPU 使用率（%）** 。

  |     指标     |                                       含义                                       |
  |------------|--------------------------------------------------------------------------------|
  | QPS        | Query Per Second，当前 OCP 管理的集群的每秒处理请求数，反映 OceanBase 集群系统处理 SQL 请求的性能，单位 time/s。 |
  | 查询响应时间     | 显示集群的平均查询响应时间，单位 us。                                                           |
  | 活跃会话数      | 显示单位时间内的活跃会话总数。                                                                |
  | CPU 使用率（%） | 显示集群内所有 OBServer 的 CPU 使用率的平均值。                                                |

* 可选择的时间范围包括： **最近一小时** 、 **最近一天** 和 **最近一周** 。

### 集群合并时间 Top5

**集群合并时间 Top5** 区域以柱状图的形式展示了最近三天内合并时间平均值从大到小排序最大的 5 个集群。合并操作（Major freeze）是将动静态数据做归并，会比较费时。当转储产生的增量数据积累到一定程度时，通过合并操作实现大版本的合并。

如果最近三天内没有集群合并，则此处为空。单击右上角图标，可对图标进行放大查看。

![1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/410/%E9%9B%86%E7%BE%A4%E5%90%88%E5%B9%B6%E6%97%B6%E9%97%B4top5.png)
