# 扩展为分布式集群

OCP 支持单机集中式在线扩展为分布式集群。

本节将为您介绍如何将单机集中式数据库扩展为分布式集群。

## 背景信息

* 当将集群拓展为单 Zone 多主机模式时，仅会扩展 OceanBase 服务的计算能力，不具备多副本高可用能力，适用于开发测试环境。
* 当将集群拓展为偶数 Zone 的模式时，将无法满足数据高可用的要求，存在数据安全风险。建议您调整配置，保持奇数的可用区配置或者为集群/租户开启仲裁服务。

## 前提条件

仅支持由 **单机集中式** 数据库扩展为分布式集群。

## 操作步骤

1. 登录 OCP 。

2. 在左侧导航栏选择 **集群**，进入集群页面。

3. 在该页面的 **集群列表** 区域，选择待操作的集群并单击其集群名。

4. 在集群 **概览** 页面右上角，单击 **扩展为分布式集群** 。

5. 在右侧弹出的面板中，设置如下信息。

    * 配置扩展相关信息。

        系统默认以 **新增 Zone** 的方式进行扩展，您可单击 **新增 OBServer** 页签选择将集群扩展为单 Zone 多主机模式。

        **新增 Zone** 模式下，如果您需要添加多个 Zone ，可以在下方单击 **新增 Zone** 按钮，添加多个 Zone 的信息。

        | **配置**  |   **描述**    |
        |---------|-------|
        | Zone 名称 | 自定义 Zone 名称。    |
        | 机房      | Zone 所在的机房。     |
        | 机型      | 可选项。如果选择了机型，后面主机列表会根据机型进行过滤。   |
        | CPU 架构  | Zone 中的 CPU 架构需与集群的 CPU 架构保持一致。<br>选择指定架构后，系统会检查是否存在符合当前集群 CPU 架构的安装包。当缺少指定架构的安装包时，将无法新增 Zone。   |
        | 主机      | 当以 **新增 Zone** 的方式进行扩展时，仅可选择一台主机作为 OBServer & rootserver；以 **新增 OBServer** 方式进行扩展时，可选择多个主机。<ul><li>当下拉列表中无可选主机时，可进行 [添加主机](../../850.host-features/200.add-a-host.md) 的操作。</li><li>生产环境下，OceanBase 数据库建议日志盘空间为主机内存空间的三倍以及以上；同时，为了避免出现性能问题，不建议数据目录和日志目录挂载在同一块磁盘上。</li></il> |

        <main id="notice" type='explain'>
        <h4>说明</h4>
        <p><ul><li>除支持添加 Zone 外，同时支持删除除 Zone1 之外的其它 Zone。需最少保留一个 Zone，否则将无法扩展。</li><li>Zone1 的名称、机房、机型、CPU 架构和主机信息不支持修改。</li></ul></p>
        </main>
    * 进行自定义设置，用于配置 OBServer 节点的操作系统所属主用户、路径及端口，详情可参考 [新建分布式集群](../200.create-a-cluster/100.create-a-distributed-cluster.md) 中 **自定义配置** 的相关说明。
    * 配置 OBServer 启动参数，参数详情说明可参见 [OceanBase 配置项](https://www.oceanbase.com/docs/common-oceanbase-database-cn-1000000000218691)。
    * 对租户进行配置，选择是否同步扩展所有租户副本。

        若勾选，则扩展为分布式集群后，将为该集群下所有的租户扩展副本，副本类型、Unit 规格、Unit 数量与原 Zone 保持一致。

   ![09161742](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/422/%E6%89%A9%E5%B1%95%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4.png)

6. 完成后，单击 **确定** 。

   您可通过弹出框中的 **查看任务** 按钮，查看新建进度。

   您也可在 **任务中心** 中查看该任务的进度。
