# 接管集群

您可通过接管集群的操作将通过黑屏操作或其它 OCP 创建的集群接管到当前 OCP 中，并通过当前 OCP 对新接管的集群继续运维和管理。

## 前提条件

* 接管集群的用户是 Cluster Manager 角色，或者具有创建集群权限。

* 待接管的 OceanBase 集群中所有 OBServer 节点都正常运行。

* 接管 OceanBase 集群时，应遵循主集群优先原则：

  * 单 OCP 场景下接管集群时，需先接管 OceanBase 主集群，再接管 OceanBase 备集群。

  * OCP 多集群场景下接管集群时，需先在某一 OCP 中接管 OceanBase 主集群后，再通过任一 OCP 接管 OceanBase 备集群。

* 被接管的 OceanBase 集群内的租户服务名与系统内现存服务名均需保持唯一，否则接管后该集群中服务名冲突的租户，服务名状态将被置为 **非法**。关于服务名的更多介绍，可参见 [管理服务名](../../700.tenant-functions/600.manage-a-tenant/800.manage-service-name.md)。

## 注意事项

* 接管 OceanBase 集群后，该 OceanBase 集群在原 OCP 集群中无法正常运维和监控，接管前请谨慎评估。
* 若被接管的集群已配置负载类型，在接管集群后，您需在集群 **概览** 页面重新为该集群配置负载类型。

## 操作步骤

1. 登录 OCP 。

2. 在左侧导航栏选择 **集群** ，系统默认进入 **集群列表** 页签。

3. 在 **集群列表** 页面，单击右上角 **接管集群** 。

4. 连接集群，支持 **直连** 和 **OBProxy** 连接两种方式。

   * **直连：** 填写集群的连接 **访问地址** 、集群的连接 **端口** 、**root@sys 密码** ，并可选择是否 **录入 proxyro 账号的密码** ，单击 **下一步** 。

      <main id="notice" type='explain'>
      <h4>说明</h4>
      <p>proxyro 账号的密码用于 OBProxy 访问 OceanBase 集群，您可在此处录入以确保 proxyro 密码的统一性。关于 proxyro 账号的更多信息，可参考 <a href="../../800.obproxy-functions/300.manage-a-obproxy-cluster/900.proxyro-user-management.md">proxyro 账号管理</a>。</p>
      </main>

      ![1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/420/%E6%8E%A5%E7%AE%A1%E9%9B%86%E7%BE%A4-%E7%9B%B4%E8%BF%9E.png)

   * **OBProxy：** 填写集群的连接 **访问地址** 、集群的连接 **端口**、**集群名**、**集群 ID（可选）**、**root@sys 密码**，并可选择是否 **录入 proxyro 账号的密码**，该账号用于 OBProxy 访问 OceanBase 集群。单击 **下一步** 。

      <main id="notice" type='explain'>
      <h4>说明</h4>
      <p><ul><li>当接管集群为备集群时，则集群 ID 为必填。主备集群都需要接管时，优先接管主集群，再接管备集群。</li><li>proxyro 账号的密码用于 OBProxy 访问 OceanBase 集群，您可在此处录入以确保 proxyro 密码的统一性。关于 proxyro 账号的更多信息，可参考 <a href="../../800.obproxy-functions/300.manage-a-obproxy-cluster/900.proxyro-user-management.md">proxyro 账号管理</a>。</li></ul></p>
      </main>

      ![1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/420/%E6%8E%A5%E7%AE%A1%E9%9B%86%E7%BE%A4-obproxy.png)

5. 连接集群成功后，进入接管检查。

   * 当检查通过时，若存在某些 OBServer 对应的主机未被 OCP 管理，OCP 需要同步接管这些主机，您需先为这些主机选择凭据，以实现 OCP 的统一管理。

   * 当检查不通过时，根据页面提示修改 OBServer 节点配置，修改完成后单击 **重新检查**。

   ![09010928](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/401/%E6%8E%A5%E7%AE%A1%E9%9B%86%E7%BE%A41.png)

6. 单击 **提交** 。

   任务提交后，您可在提交结果页面查看任务执行进度或返回集群概览页面。

    <main id="notice" type='explain'>
    <h4>说明</h4>
    <p>由于 OCP 连接数据库需要在凭据管理中有对应的凭据串存在，当接管集群完成后，您可将 <a href="650.migrate-a-cluster.md">导出集群</a> 时获取的集群凭据文件导入此 OCP 中，方便您批量上传集群的凭据信息，具体操作详情可参见 <a href="../../1600.system-management-features/100.manage-password-box/300.import-a-credential.md">导入凭据</a>。</p>
    </main>
