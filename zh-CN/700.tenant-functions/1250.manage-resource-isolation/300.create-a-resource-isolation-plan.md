# 创建资源隔离计划

当您需要细化租户资源隔离的情况下，OCP 提供可视化的方式对租户资源进行隔离划分，系统将按照您所配置的资源隔离计划将资源分配给对应的资源组，降低您管理租户资源的复杂度。

## 前提条件

* 仅 OceanBase V4.1 及以上版本支持创建资源隔离计划。
* 当前集群已开启 cgroup 能力。

<main id="notice" type='explain'>
<h4>注意</h4>
<p>当集群未开启 cgroup 能力时，租户的资源隔离配置将无法生效。建议启用 cgroup 后使用资源隔离功能，具体启用方式请联系技术工程师支持。</p>
</main>

## 操作步骤

1. 登录 OCP。

2. 在左侧导航栏中单击 **租户** 。

3. 在 **租户列表** 中选择具体的租户并单击其租户名。

   默认进入租户 **概览** 页面。

4. 在左侧显示的导航栏中单击 **资源隔离** ，进入该租户的 **资源隔离** 页面。

5. 单击 **创建隔离计划** 按钮，进入 **创建资源隔离计划** 页面。

6. 输入计划基本信息，包括 **计划名称** 及 **说明信息**。

    |  参数  |  说明   |
    |--------|---------|
    |  计划名称      |  指定资源隔离计划名称，支持英文、数字、下划线组合，长度在 2 ~ 32。       |
    |  说明信息      |  （可选）配置资源隔离计划的备注信息，支持任意字符，长度在 1000 以内。       |

    ![1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/420/%E8%B5%84%E6%BA%90%E9%9A%94%E7%A6%BB%E8%AE%A1%E5%88%92.png)

    单击 **下一步**。

7. 为资源隔离计划选择资源组。

    在 **资源组名称** 中选择已经创建的 **资源组**，系统将在下方自动填充资源组的资源隔离方式及匹配规则信息。资源组不支持重复选择，每个资源组仅适用于一个资源隔离计划。

    * 当租户未创建资源组时，支持单击 **资源组名称** 中的 **新建资源组** 为租户创建新的资源组，操作详情请参见 [创建资源组](200.create-a-resource-group.md)。
    * 单击 **添加资源组**，可为本资源隔离计划配置多个资源组。
    * 单击资源组右上方的删除图标，可在资源隔离计划中移除该资源组。

    ![1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/420/%E8%B5%84%E6%BA%90%E7%BB%84%E9%85%8D%E7%BD%AE.png)

    单击 **下一步**。

8. 为资源组配置资源隔离限制。

    |  参数  |  说明   |
    |--------|---------|
    |  CPU 上限      |  （可选）UTILIZATION_LIMIT：指定资源组使用的 CPU 资源的上限。该参数的默认值为 100，取值范围为 [0, 100]。IOPS 下限不能大于 IOPS 上限       |
    |  CPU 权重      |  （可选）MGMT_P1：指定系统满负载情况下，承诺分配给本资源组的 CPU 占比。默认值为 100。 </br> 计算方式：当前 MGMT_P1 配置值 * 100 / 当前隔离计划所有资源组 MGMT_P1 配置值。      |
    |  IOPS 下限      |  （可选）MIN_IOPS：用于出现 IO 争用时，资源组预留的 IOPS 资源，总和不超过 100，默认值为 0。本资源组可配置的最大值受其他资源组影响。<ul><li>如果租户内 UINT IOPS 规格一致，将只展示本资源组预留的 IOPS 统一值。</li><li>如果租户内 UINT IOPS 规格不一致，则展示本资源组不同 Zone 下预留的 IOPS 值。</li></ul>       |
    |  IOPS 上限      |  （可选）MAX_IOPS：用于指定资源组最大可使用的 IOPS 资源，总和可以超过 100，默认值为 100。<ul><li>如果租户内 UINT IOPS 规格一致，将只展示本资源组最大可使用 IOPS 的统一值。</li><li>如果租户内 UINT IOPS 规格不一致，则展示本资源组不同 Zone 下最大可使用的 IOPS 值。</li></ul> <main id="notice" type='notice'><h4>注意</h4><p>IOPS 上限不能小于 IOPS 下限。</p></main>      |
    |  IOPS 权重      |  （可选）WEIGHT_IOPS：用于指定 IOPS 的权重值，在满足所有资源组预留 IOPS 前提下，本资源组可额外分配的 IOPS 占比。总和可以超过 100，默认值为 0。<br>计算方式：当前 WEIGHT_IOPS 配置值 * 100 / 当前隔离计划所有资源组 WEIGHT_IOPS 配置值。      |

    <main id="notice" type='explain'>
    <h4>说明</h4>
    <p>权重的计算受其他资源组配置影响会动态变化。</p>
    </main>

    ![1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/420/%E8%B5%84%E6%BA%90%E9%9A%94%E7%A6%BB%E9%99%90%E5%88%B6.png)

    单击 **下一步**。

9. 确认配置。

    确认所配置的资源隔离计划信息是否正确，并单击 **确定** 进行提交。

    ![1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/420/%E7%A1%AE%E8%AE%A4%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF.png)
