# 管理客户端配置

为实现业务流量的负载均衡，客户端驱动（如 JDBC 驱动）需要对应的流量入口节点及对应流量分配策略。您可通过 **客户端配置**，以应用的形式将 OBProxy 集群的节点信息与负载均衡策略与客户端程序实现同步，客户端获取应用配置信息以实现负载均衡能力。

## 新增应用

1. 登录 OCP。

2. 在左侧导航栏单击 **OBProxy** 。

3. 在集群列表中选择需要操作的 OBProxy 集群，进入 OBProxy 集群 **概览** 页面。

4. 单击左侧导航栏的 **客户端配置** ，默认进入 **客户端配置** 总览页面。
5. 单击右上角 **新增应用**，在右侧面板中输入应用信息。

    |  参数  |   说明   |
    |----------|----------|
    |  应用名   |  应用的名称，需要以英文字母开头，可包括大写字母、小写字母、数字和下划线，长度在 4~32 之间。 <blockquote>**注意**</br>应用名全局唯一，OCP 中不可存在相同的应用名。</blockquote>      |
    |  说明   |   可选，应用的相关说明，长度为 0~256 个字。      |
    |  负载均衡   |  当配置多个负载均衡策略时，客户端程序将按下方负载均衡 **策略** 的配置顺序，以轮询的方式使用负载均衡配置。需为应用至少配置一种负载均衡策略。      |
    |  策略   | 选择负载的策略，包括 **RANDOM**、**SERVERAFFINITY** 和 **ROTATION** 三种策略模式，策略不可重复选择。 <ul><li>RANDOM：随机</li> <li>SERVERAFFINITY：加权</li><li>ROTATION：轮询</li>  </ul>     |
    |  OBProxy   |  配置负载均衡策略下的 OBProxy 列表，展示格式为 `IP 地址:端口号(权重)`，支持多选。其中权重仅在负载均衡为 **SERVERAFFINITY** 时使用，支持配置 1~10 范围内的数字，数字越大代表权重越高。       |
    |  全局配置   |  配置应用全局的相关信息。       |
    |  OBLB_RETRY_ALL_DOWNS  |  可选，配置当前应用下所有节点尝试连接次数，超过指定阈值后则抛出连接异常。    |
    |  节点加入黑名单策略   |  配置主机被加入黑名单的策略，默认关闭，包括 NORMAL 和 RETRYTIMES 两种模式。<ul><li>NORMAL：普通策略。默认策略，只要主机的 connect 动作抛出网络异常就会被添加至黑名单，不需要其他的参数配合。</li> <li>RETRYTIMES：时间段内重试。在一段时间内重试了特定次数就会被添加到黑名单，相关配置包括 **RETRYTIMES** 和 **DURATION**。</li> </ul>    |
    |  DURATION   |   **节点加入黑名单策略** 选择 **RETRYTIMES** 模式时展示。      |
    |  RETRYTIMES   |   **节点加入黑名单策略** 选择 **RETRYTIMES** 模式时展示。      |
    |  节点移除黑名单策略   |   开启后，经过指定时长后节点将会从黑名单内移除。      |
    |  TIMEOUT   |   开启 **节点移除黑名单策略** 时展示，默认策略，用于配置节点在黑名单中的时长，超过 TIMEOUT 的时间会被移除黑名单。      |

    ![1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/402-cn/%E6%96%B0%E5%A2%9E%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E5%BA%94%E7%94%A8.png)

6. 单击 **确定**。

## 修改应用

1. 登录 OCP。

2. 在左侧导航栏单击 **OBProxy** 。

3. 在集群列表中选择需要操作的 OBProxy 集群，进入 OBProxy 集群 **总览** 页面。

4. 单击左侧导航栏的 **客户端配置** ，默认进入 **客户端配置** 总览页面。

5. 选择需要编辑的应用，单击应用右上角的 **编辑**。

6. 在弹出的面板中修改相关信息，并单击 **确定** 进行保存。

## 删除应用

1. 登录 OCP。

2. 在左侧导航栏单击 **OBProxy** 。

3. 在集群列表中选择需要操作的 OBProxy 集群，进入 OBProxy 集群 **总览** 页面。

4. 单击左侧导航栏的 **客户端配置** ，默认进入 **客户端配置** 总览页面。

5. 选择需要删除的应用，单击应用右上角的 **删除**。

6. 在弹出的对话框中单击 **删除**。

    <main id="explain" type='alert'>
    <h4>说明</h4>
    <p>删除后客户端程序将无法引用该配置实现负载均衡能力，请谨慎操作。</p>
    </main>
