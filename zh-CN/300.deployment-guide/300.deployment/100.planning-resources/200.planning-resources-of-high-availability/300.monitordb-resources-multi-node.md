# MonitorDB 资源

OCP 在运行过程中，会采集管理目标的各种性能数据，主要是 OceanBase 集群的数据，这些数据都会存储到 MonitorDB。推荐在 OceanBase 中创建独立的租户用于 MonitorDB。

对于管理规模较大的场景，推荐部署独立的 OceanBase 集群用于 MonitorDB。MonitorDB 推荐的最低配置是每个副本分配 4 个 CPU、16GB 内存。

## CPU 和内存

按照 OCP 管理的 OBServer 节点数量，为您推荐 MonitorDB 租户每个副本的 CPU 和内存资源。以下配置是以每个集群中包含 10 个租户为标准，进行计算得出的数据，请您根据实际情况进行计算，选择合适的 CPU 和内存。

| **管理机器数量（台）** | **CPU（核心数）** | **内存（GB）** |
|---------------|--------------|------------|
| ≤10           | 4            | 16         |
| ≤50           | 16           | 64         |
| ≤100          | 32           | 128        |
| ≤200          | 64           | 256        |
| ≤400          | 128          | 512        |

## 磁盘容量预估

* 估算说明：监控数据主要分为指标数据和 SQL 执行记录两部分。

  * 指标数据，存储消耗大约为每 Server 每天增量 100MB\~300MB。

  * SQL 执行记录，存储消耗与业务用量有关，经验值是数据规模大约为指标数据的 10 倍\~50 倍。

  按照经验值估算，平均每 Server 一天的监控数据增量为 1GB\~40GB，按照 20GB 预估。OCP 使用分区表保存监控数据，监控数据的保留周期如下：

  * 指标数据：秒级保留 8 天，分钟级保留 31 天。

  * SQL 执行记录：保留 8 天。

由于大部分存储空间由 SQL 执行记录占用，估算磁盘资源使用时基于 SQL 执行记录进行估算。

* 资源估算公式：待管理的所有 OceanBase 集群机器数量。下述以为 server_count 为例：

  * OCP 监控数据库每天的数据增量预估为 server_count\*20GB。

  * MonitorDB 存储需求为每天的数据增量 \* 8 天。

* 估算样例：待管理的所有 OceanBase 集群机器数量。下述以 20 为例：

  * OCP 监控数据库每天的数据增量预估为 20\*20GB = 400GB。

  * MonitorDB 存储容量预估为 400GB/天\*8 天=3200GB，约 3.2TB。

  <main id="notice" type='explain'>
    <h4>说明</h4>
    <p>前面给出的资源消耗只是一个粗略的预估，实际的 MonitorDB 资源消耗根据业务用量会有差异。</p>
  </main>
